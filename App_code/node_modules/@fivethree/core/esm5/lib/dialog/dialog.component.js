/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FivLoadingProgressBar } from './../loading-progress-bar/loading-progress-bar.component';
import { EventEmitter, Output, Input, ElementRef, Renderer2 } from '@angular/core';
import { Component, ViewChild } from '@angular/core';
import { FivOverlay } from '../overlay/overlay.component';
import { trigger, transition, style, animate, state, AnimationBuilder } from '@angular/animations';
import { DomController } from '@ionic/angular';
var FivDialog = /** @class */ (function () {
    function FivDialog(renderer, domCtrl, animation) {
        this.renderer = renderer;
        this.domCtrl = domCtrl;
        this.animation = animation;
        this.verticalAlign = 'top';
        this.horizontalAlign = 'middle';
        this.shape = 'card';
        this.priority = 20001;
        this.backdrop = true;
        this.backdropDismiss = true;
        this.pullEnabled = true;
        // animation data
        this.inDuration = 160;
        this.outDuration = 120;
        this.outPosition = '-100%';
        this.toPosition = '0px';
        this.translate = '0px';
        this.fivClose = new EventEmitter();
        this.fivDurationOver = new EventEmitter();
        this.fivOpen = new EventEmitter();
        this.dialogState = 'out';
    }
    /**
     * @return {?}
     */
    FivDialog.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    FivDialog.prototype.open = /**
     * @return {?}
     */
    function () {
        this.overlay.show(this.priority);
        this.dialogState = this.verticalAlign;
        if (this.duration) {
            this.bar.shrinkIn(this.duration);
        }
    };
    /**
     * @return {?}
     */
    FivDialog.prototype.doneShrinking = /**
     * @return {?}
     */
    function () {
        this.fivDurationOver.emit(this);
    };
    /**
     * @return {?}
     */
    FivDialog.prototype.close = /**
     * @return {?}
     */
    function () {
        this.dialogState = 'out';
        this.bar.stopProgressAnimation();
    };
    /**
     * @return {?}
     */
    FivDialog.prototype.backdropClick = /**
     * @return {?}
     */
    function () {
        if (this.backdropDismiss) {
            this.close();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FivDialog.prototype.animationDone = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.fromState !== 'void' && event.toState === 'out') {
            this.transformDialog(0);
            this.overlay.hide();
            this.fivClose.emit(this);
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FivDialog.prototype.backdropAnimDone = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.fromState === 'out' && event.toState !== 'void') {
            this.fivOpen.emit(this);
        }
    };
    /**
     * @return {?}
     */
    FivDialog.prototype.onRefresh = /**
     * @return {?}
     */
    function () {
        this.close();
    };
    /**
     * @return {?}
     */
    FivDialog.prototype.fivCancel = /**
     * @return {?}
     */
    function () {
        this.resetDialog(this.currentPullProgress);
    };
    /**
     * @param {?} progress
     * @return {?}
     */
    FivDialog.prototype.transformDialog = /**
     * @param {?} progress
     * @return {?}
     */
    function (progress) {
        var _this = this;
        this.currentPullProgress = progress;
        this.domCtrl.write((/**
         * @return {?}
         */
        function () {
            if (_this.verticalAlign === 'bottom') {
                _this.renderer.setStyle(_this.dialogRef.nativeElement, 'margin-bottom', "-" + progress * 120 + "px");
            }
            else if (_this.verticalAlign === 'top') {
                _this.renderer.setStyle(_this.dialogRef.nativeElement, 'margin-top', "-" + progress * 120 + "px");
            }
            else if (_this.verticalAlign === 'center') {
                _this.renderer.setStyle(_this.dialogRef.nativeElement, 'margin-top', progress * 120 + "px");
            }
        }));
    };
    /**
     * @param {?} progress
     * @return {?}
     */
    FivDialog.prototype.resetDialog = /**
     * @param {?} progress
     * @return {?}
     */
    function (progress) {
        var _this = this;
        /** @type {?} */
        var reset;
        if (this.verticalAlign === 'bottom') {
            reset = this.animation.build([
                style({ 'margin-bottom': "-" + progress * 120 + "px" }),
                animate('150ms', style({ 'margin-bottom': "0px" }))
            ]);
        }
        else if (this.verticalAlign === 'top') {
            reset = this.animation.build([
                style({ 'margin-top': "-" + progress * 120 + "px" }),
                animate('150ms', style({ 'margin-top': "0px" }))
            ]);
        }
        else if (this.verticalAlign === 'center') {
            reset = this.animation.build([
                style({ 'margin-top': progress * 120 + "px" }),
                animate('150ms', style({ 'margin-top': "0px" }))
            ]);
        }
        /** @type {?} */
        var animation = reset.create(this.dialogRef.nativeElement);
        animation.play();
        animation.onDone((/**
         * @return {?}
         */
        function () {
            animation.destroy();
            _this.transformDialog(0);
        }));
    };
    FivDialog.decorators = [
        { type: Component, args: [{
                    selector: 'fiv-dialog',
                    template: "<fiv-overlay #overlay>\n  <ion-content no-bounce [direction]=\"verticalAlign === 'top' ? 'up' : 'down'\" fivPull [enabled]=\"pullEnabled\" [maxPullHeight]=\"168\" [minPullHeight]=\"120\" (fivPull)=\"transformDialog($event)\"\n  (fivRefresh)=\"onRefresh()\" (fivCancel)=\"fivCancel()\"  *ngIf=\"backdrop\" (@fade.done)=\"backdropAnimDone($event)\"\n    [@fade]=\"{value: dialogState, params: { opacity: 0, inDuration: '120ms' }}\" (click)=\"backdropClick()\" class=\"backdrop\">\n</ion-content>\n  <div #dialog [@fade]=\"{value: dialogState, params: { opacity: 0, inDuration: '120ms' }}\"\n  [@slide]=\"{value: dialogState, params: {top: outPosition, inDuration: inDuration + 'ms',outDuration: outDuration + 'ms', toPosition: toPosition, translate: translate,translateX: horizontalAlign === 'middle' ? 'translateX(-50%)' :  '' }}\"\n  (@slide.done)=\"animationDone($event)\" class=\"dialog\" [ngClass]=\"[verticalAlign, horizontalAlign, shape]\">\n    <ng-container>\n      <ng-container *ngTemplateOutlet=\"card\"></ng-container>\n    </ng-container>\n  </div>\n\n</fiv-overlay>\n\n<ng-template #card>\n  <ion-card>\n    <fiv-loading-progress-bar [verticalAlign]=\"verticalAlign === 'top' ? 'bottom' : 'top'\"\n      (fivDoneShrinking)=\"doneShrinking()\" #bar></fiv-loading-progress-bar>\n    <ng-content></ng-content>\n  </ion-card>\n</ng-template>",
                    animations: [
                        trigger('slide', [
                            transition('out => top', [
                                style({ top: '0', transform: 'translateY(-100%) {{translateX}}' }),
                                animate('220ms ease-out')
                            ]),
                            transition('out => center', [
                                style({
                                    top: '50%',
                                    transform: 'translateY(-50%) {{translateX}} scale(0)',
                                    opacity: 0
                                }),
                                animate('220ms ease-out', style({
                                    top: '50%',
                                    transform: 'translateY(-50%) {{translateX}} scale(1)',
                                    opacity: 1
                                }))
                            ]),
                            transition('out => bottom', [
                                style({ bottom: '0', transform: 'translateY(100%) {{translateX}}' }),
                                animate('220ms ease-out')
                            ]),
                            transition('top => out', [
                                style({ top: '0', transform: '*' }),
                                animate('140ms ease-in', style({ top: '0', transform: 'translateY(-100%) {{translateX}}' }))
                            ]),
                            transition('center => out', [
                                style({
                                    top: '50%',
                                    transform: '*',
                                    opacity: 1
                                }),
                                animate('140ms ease-in', style({
                                    top: '50%',
                                    transform: 'translateY(-50%) {{translateX}} scale(0)',
                                    opacity: 0
                                }))
                            ]),
                            transition('bottom => out', [
                                style({ bottom: '0', transform: '*' }),
                                animate('140ms ease-in', style({ bottom: '0', transform: 'translateY(100%) {{translateX}}' }))
                            ]),
                        ]),
                        trigger('fade', [
                            transition('out => *', [
                                style({ opacity: '{{opacity}}' }),
                                animate('{{inDuration}} ease-out', style({ opacity: '1' }))
                            ], { params: { opacity: 0, inDuration: '250ms' } }),
                            transition('* => out', [
                                style({ opacity: '1' }),
                                animate('{{outDuration}} ease-in', style({ opacity: '0' }))
                            ], { params: { opacity: 0, outDuration: '200ms' } }),
                            state('out', style({ opacity: '0' }))
                        ])
                    ],
                    styles: ["ion-grid{--ion-grid-padding:0;--ion-grid-column-padding:0}.dialog{--min-width:340px;--ion-item-background:#fff;position:absolute;min-width:var(--min-width)}@media (max-width:600px){.dialog{--min-width:100%}}.dialog.fill{background:var(--ion-item-background);box-shadow:0 4px 16px rgba(0,0,0,.12)}.dialog.fill .sc-ion-card-ios-h,.dialog.fill .sc-ion-card-md-h{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:0;margin-inline-end:0;box-shadow:none;margin-top:0;margin-bottom:0}.dialog.fill.bottom .sc-ion-card-ios-h,.dialog.fill.bottom .sc-ion-card-md-h,.dialog.fill.top .sc-ion-card-ios-h,.dialog.fill.top .sc-ion-card-md-h{border-radius:0}.dialog.top.left{padding-top:env(safe-area-inset-top);top:0;left:0}.dialog.top.right{padding-top:env(safe-area-inset-top);top:0;right:0}.dialog.top.middle{padding-top:env(safe-area-inset-top);top:0;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%)}.dialog.center.middle{padding-top:env(safe-area-inset-top);top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.dialog.center.left{top:50%;padding-top:env(safe-area-inset-top);left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.dialog.center.right{right:0;top:50%;padding-top:env(safe-area-inset-top);-webkit-transform:translateY(-50%);transform:translateY(-50%)}.dialog.bottom.left{bottom:0;left:0;padding-bottom:env(safe-area-inset-bottom)}.dialog.bottom.right{bottom:0;right:0;padding-bottom:env(safe-area-inset-bottom)}.dialog.bottom.middle{bottom:0;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);padding-bottom:env(safe-area-inset-bottom)}.backdrop{width:100%;height:100%;--background:rgba(0, 0, 0, 0.2);position:absolute}"]
                }] }
    ];
    /** @nocollapse */
    FivDialog.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: DomController },
        { type: AnimationBuilder }
    ]; };
    FivDialog.propDecorators = {
        verticalAlign: [{ type: Input }],
        horizontalAlign: [{ type: Input }],
        shape: [{ type: Input }],
        priority: [{ type: Input }],
        backdrop: [{ type: Input }],
        backdropDismiss: [{ type: Input }],
        pullEnabled: [{ type: Input }],
        duration: [{ type: Input }],
        inDuration: [{ type: Input }],
        outDuration: [{ type: Input }],
        fivClose: [{ type: Output }],
        fivDurationOver: [{ type: Output }],
        fivOpen: [{ type: Output }],
        overlay: [{ type: ViewChild, args: [FivOverlay,] }],
        bar: [{ type: ViewChild, args: [FivLoadingProgressBar,] }],
        dialogRef: [{ type: ViewChild, args: ['dialog',] }]
    };
    return FivDialog;
}());
export { FivDialog };
if (false) {
    /** @type {?} */
    FivDialog.prototype.verticalAlign;
    /** @type {?} */
    FivDialog.prototype.horizontalAlign;
    /** @type {?} */
    FivDialog.prototype.shape;
    /** @type {?} */
    FivDialog.prototype.priority;
    /** @type {?} */
    FivDialog.prototype.backdrop;
    /** @type {?} */
    FivDialog.prototype.backdropDismiss;
    /** @type {?} */
    FivDialog.prototype.pullEnabled;
    /** @type {?} */
    FivDialog.prototype.duration;
    /** @type {?} */
    FivDialog.prototype.inDuration;
    /** @type {?} */
    FivDialog.prototype.outDuration;
    /** @type {?} */
    FivDialog.prototype.outPosition;
    /** @type {?} */
    FivDialog.prototype.toPosition;
    /** @type {?} */
    FivDialog.prototype.translate;
    /** @type {?} */
    FivDialog.prototype.fivClose;
    /** @type {?} */
    FivDialog.prototype.fivDurationOver;
    /** @type {?} */
    FivDialog.prototype.fivOpen;
    /** @type {?} */
    FivDialog.prototype.overlay;
    /** @type {?} */
    FivDialog.prototype.bar;
    /** @type {?} */
    FivDialog.prototype.dialogRef;
    /** @type {?} */
    FivDialog.prototype.dialogState;
    /** @type {?} */
    FivDialog.prototype.currentPullProgress;
    /**
     * @type {?}
     * @private
     */
    FivDialog.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FivDialog.prototype.domCtrl;
    /**
     * @type {?}
     * @private
     */
    FivDialog.prototype.animation;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZGlhbG9nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BmaXZldGhyZWUvY29yZS8iLCJzb3VyY2VzIjpbImxpYi9kaWFsb2cvZGlhbG9nLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sMERBQTBELENBQUM7QUFDakcsT0FBTyxFQUNMLFlBQVksRUFDWixNQUFNLEVBQ04sS0FBSyxFQUdMLFVBQVUsRUFDVixTQUFTLEVBQ1YsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFFLFNBQVMsRUFBVSxTQUFTLEVBQUUsTUFBTSxlQUFlLENBQUM7QUFDN0QsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLDhCQUE4QixDQUFDO0FBQzFELE9BQU8sRUFDTCxPQUFPLEVBQ1AsVUFBVSxFQUNWLEtBQUssRUFDTCxPQUFPLEVBQ1AsS0FBSyxFQUNMLGdCQUFnQixFQUNqQixNQUFNLHFCQUFxQixDQUFDO0FBQzdCLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUcvQztJQWdIRSxtQkFDVSxRQUFtQixFQUNuQixPQUFzQixFQUN0QixTQUEyQjtRQUYzQixhQUFRLEdBQVIsUUFBUSxDQUFXO1FBQ25CLFlBQU8sR0FBUCxPQUFPLENBQWU7UUFDdEIsY0FBUyxHQUFULFNBQVMsQ0FBa0I7UUEvQjVCLGtCQUFhLEdBQWdDLEtBQUssQ0FBQztRQUNuRCxvQkFBZSxHQUFnQyxRQUFRLENBQUM7UUFDeEQsVUFBSyxHQUFvQixNQUFNLENBQUM7UUFDaEMsYUFBUSxHQUFHLEtBQUssQ0FBQztRQUVqQixhQUFRLEdBQUcsSUFBSSxDQUFDO1FBQ2hCLG9CQUFlLEdBQUcsSUFBSSxDQUFDO1FBQ3ZCLGdCQUFXLEdBQUcsSUFBSSxDQUFDOztRQUduQixlQUFVLEdBQUcsR0FBRyxDQUFDO1FBQ2pCLGdCQUFXLEdBQUcsR0FBRyxDQUFDO1FBQzNCLGdCQUFXLEdBQUcsT0FB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OEJBQTJDOztJQUUzQyxnQ0FBeUQ7O0lBQ3pELHdDQUE0Qjs7Ozs7SUFLMUIsNkJBQTJCOzs7OztJQUMzQiw0QkFBOEI7Ozs7O0lBQzlCLDhCQUFtQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEZpdkxvYWRpbmdQcm9ncmVzc0JhciB9IGZyb20gJy4vLi4vbG9hZGluZy1wcm9ncmVzcy1iYXIvbG9hZGluZy1wcm9ncmVzcy1iYXIuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIEV2ZW50RW1pdHRlcixcbiAgT3V0cHV0LFxuICBJbnB1dCxcbiAgVGVtcGxhdGVSZWYsXG4gIFR5cGUsXG4gIEVsZW1lbnRSZWYsXG4gIFJlbmRlcmVyMlxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0LCBWaWV3Q2hpbGQgfSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZpdk92ZXJsYXkgfSBmcm9tICcuLi9vdmVybGF5L292ZXJsYXkuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIHRyaWdnZXIsXG4gIHRyYW5zaXRpb24sXG4gIHN0eWxlLFxuICBhbmltYXRlLFxuICBzdGF0ZSxcbiAgQW5pbWF0aW9uQnVpbGRlclxufSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IERvbUNvbnRyb2xsZXIgfSBmcm9tICdAaW9uaWMvYW5ndWxhcic7XG5leHBvcnQgdHlwZSBDb250ZW50PFQ+ID0gVGVtcGxhdGVSZWY8VD4gfCBUeXBlPFQ+O1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdmaXYtZGlhbG9nJyxcbiAgdGVtcGxhdGVVcmw6ICcuL2RpYWxvZy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL2RpYWxvZy5jb21wb25lbnQuc2NzcyddLFxuICBhbmltYXRpb25zOiBbXG4gICAgdHJpZ2dlcignc2xpZGUnLCBbXG4gICAgICB0cmFuc2l0aW9uKCdvdXQgPT4gdG9wJywgW1xuICAgICAgICBzdHlsZSh7IHRvcDogJzAnLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKC0xMDAlKSB7e3RyYW5zbGF0ZVh9fScgfSksXG4gICAgICAgIGFuaW1hdGUoJzIyMG1zIGVhc2Utb3V0JylcbiAgICAgIF0pLFxuICAgICAgdHJhbnNpdGlvbignb3V0ID0+IGNlbnRlcicsIFtcbiAgICAgICAgc3R5bGUoe1xuICAgICAgICAgIHRvcDogJzUwJScsXG4gICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtNTAlKSB7e3RyYW5zbGF0ZVh9fSBzY2FsZSgwKScsXG4gICAgICAgICAgb3BhY2l0eTogMFxuICAgICAgICB9KSxcbiAgICAgICAgYW5pbWF0ZShcbiAgICAgICAgICAnMjIwbXMgZWFzZS1vdXQnLFxuICAgICAgICAgIHN0eWxlKHtcbiAgICAgICAgICAgIHRvcDogJzUwJScsXG4gICAgICAgICAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKC01MCUpIHt7dHJhbnNsYXRlWH19IHNjYWxlKDEpJyxcbiAgICAgICAgICAgIG9wYWNpdHk6IDFcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJ291dCA9PiBib3R0b20nLCBbXG4gICAgICAgIHN0eWxlKHsgYm90dG9tOiAnMCcsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoMTAwJSkge3t0cmFuc2xhdGVYfX0nIH0pLFxuICAgICAgICBhbmltYXRlKCcyMjBtcyBlYXNlLW91dCcpXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJ3RvcCA9PiBvdXQnLCBbXG4gICAgICAgIHN0eWxlKHsgdG9wOiAnMCcsIHRyYW5zZm9ybTogJyonIH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICcxNDBtcyBlYXNlLWluJyxcbiAgICAgICAgICBzdHlsZSh7IHRvcDogJzAnLCB0cmFuc2Zvcm06ICd0cmFuc2xhdGVZKC0xMDAlKSB7e3RyYW5zbGF0ZVh9fScgfSlcbiAgICAgICAgKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCdjZW50ZXIgPT4gb3V0JywgW1xuICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgdG9wOiAnNTAlJyxcbiAgICAgICAgICB0cmFuc2Zvcm06ICcqJyxcbiAgICAgICAgICBvcGFjaXR5OiAxXG4gICAgICAgIH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICcxNDBtcyBlYXNlLWluJyxcbiAgICAgICAgICBzdHlsZSh7XG4gICAgICAgICAgICB0b3A6ICc1MCUnLFxuICAgICAgICAgICAgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgtNTAlKSB7e3RyYW5zbGF0ZVh9fSBzY2FsZSgwKScsXG4gICAgICAgICAgICBvcGFjaXR5OiAwXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCdib3R0b20gPT4gb3V0JywgW1xuICAgICAgICBzdHlsZSh7IGJvdHRvbTogJzAnLCB0cmFuc2Zvcm06ICcqJyB9KSxcbiAgICAgICAgYW5pbWF0ZShcbiAgICAgICAgICAnMTQwbXMgZWFzZS1pbicsXG4gICAgICAgICAgc3R5bGUoeyBib3R0b206ICcwJywgdHJhbnNmb3JtOiAndHJhbnNsYXRlWSgxMDAlKSB7e3RyYW5zbGF0ZVh9fScgfSlcbiAgICAgICAgKVxuICAgICAgXSksXG4gICAgICAvLyBzdGF0ZSgnYm90dG9tJywgc3R5bGUoeyBib3R0b206ICcwJywgdHJhbnNmb3JtOiAnKicgfSkpLFxuICAgICAgLy8gc3RhdGUoJ3RvcCcsIHN0eWxlKHsgdG9wOiAnMCcsIHRyYW5zZm9ybTogJyonIH0pKSxcbiAgICAgIC8vIHN0YXRlKCdjZW50ZXInLCBzdHlsZSh7IHRvcDogJzUwJScsIHRyYW5zZm9ybTogJ3RyYW5zbGF0ZVkoLTUwJSkge3t0cmFuc2xhdGVYfX0nIH0pKVxuICAgIF0pLFxuICAgIHRyaWdnZXIoJ2ZhZGUnLCBbXG4gICAgICB0cmFuc2l0aW9uKFxuICAgICAgICAnb3V0ID0+IConLFxuICAgICAgICBbXG4gICAgICAgICAgc3R5bGUoeyBvcGFjaXR5OiAne3tvcGFjaXR5fX0nIH0pLFxuICAgICAgICAgIGFuaW1hdGUoJ3t7aW5EdXJhdGlvbn19IGVhc2Utb3V0Jywgc3R5bGUoeyBvcGFjaXR5OiAnMScgfSkpXG4gICAgICAgIF0sXG4gICAgICAgIHsgcGFyYW1zOiB7IG9wYWNpdHk6IDAsIGluRHVyYXRpb246ICcyNTBtcycgfSB9XG4gICAgICApLFxuICAgICAgdHJhbnNpdGlvbihcbiAgICAgICAgJyogPT4gb3V0JyxcbiAgICAgICAgW1xuICAgICAgICAgIHN0eWxlKHsgb3BhY2l0eTogJzEnIH0pLFxuICAgICAgICAgIGFuaW1hdGUoJ3t7b3V0RHVyYXRpb259fSBlYXNlLWluJywgc3R5bGUoeyBvcGFjaXR5OiAnMCcgfSkpXG4gICAgICAgIF0sXG4gICAgICAgIHsgcGFyYW1zOiB7IG9wYWNpdHk6IDAsIG91dER1cmF0aW9uOiAnMjAwbXMnIH0gfVxuICAgICAgKSxcbiAgICAgIHN0YXRlKCdvdXQnLCBzdHlsZSh7IG9wYWNpdHk6ICcwJyB9KSlcbiAgICBdKVxuICBdXG59KVxuZXhwb3J0IGNsYXNzIEZpdkRpYWxvZyBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIEBJbnB1dCgpIHZlcnRpY2FsQWxpZ246ICdib3R0b20nIHwgJ2NlbnRlcicgfCAndG9wJyA9ICd0b3AnO1xuICBASW5wdXQoKSBob3Jpem9udGFsQWxpZ246ICdsZWZ0JyB8ICdtaWRkbGUnIHwgJ3JpZ2h0JyA9ICdtaWRkbGUnO1xuICBASW5wdXQoKSBzaGFwZTogJ2ZpbGwnIHwgJ2NhcmQnID0gJ2NhcmQnO1xuICBASW5wdXQoKSBwcmlvcml0eSA9IDIwMDAxO1xuXG4gIEBJbnB1dCgpIGJhY2tkcm9wID0gdHJ1ZTtcbiAgQElucHV0KCkgYmFja2Ryb3BEaXNtaXNzID0gdHJ1ZTtcbiAgQElucHV0KCkgcHVsbEVuYWJsZWQgPSB0cnVlO1xuICBASW5wdXQoKSBkdXJhdGlvbjogbnVtYmVyO1xuICAvLyBhbmltYXRpb24gZGF0YVxuICBASW5wdXQoKSBpbkR1cmF0aW9uID0gMTYwO1xuICBASW5wdXQoKSBvdXREdXJhdGlvbiA9IDEyMDtcbiAgb3V0UG9zaXRpb24gPSAnLTEwMCUnO1xuICB0b1Bvc2l0aW9uID0gJzBweCc7XG4gIHRyYW5zbGF0ZSA9ICcwcHgnO1xuXG4gIEBPdXRwdXQoKSBmaXZDbG9zZTogRXZlbnRFbWl0dGVyPEZpdkRpYWxvZz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBPdXRwdXQoKSBmaXZEdXJhdGlvbk92ZXI6IEV2ZW50RW1pdHRlcjxGaXZEaWFsb2c+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuICBAT3V0cHV0KCkgZml2T3BlbjogRXZlbnRFbWl0dGVyPEZpdkRpYWxvZz4gPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIEBWaWV3Q2hpbGQoRml2T3ZlcmxheSkgb3ZlcmxheTogRml2T3ZlcmxheTtcbiAgQFZpZXdDaGlsZChGaXZMb2FkaW5nUHJvZ3Jlc3NCYXIpIGJhcjogRml2TG9hZGluZ1Byb2dyZXNzQmFyO1xuICBAVmlld0NoaWxkKCdkaWFsb2cnKSBkaWFsb2dSZWY6IEVsZW1lbnRSZWY7XG5cbiAgZGlhbG9nU3RhdGU6ICd0b3AnIHwgJ2NlbnRlcicgfCAnYm90dG9tJyB8ICdvdXQnID0gJ291dCc7XG4gIGN1cnJlbnRQdWxsUHJvZ3Jlc3M6IG51bWJlcjtcblxuICBuZ09uSW5pdCgpOiB2b2lkIHsgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMixcbiAgICBwcml2YXRlIGRvbUN0cmw6IERvbUNvbnRyb2xsZXIsXG4gICAgcHJpdmF0ZSBhbmltYXRpb246IEFuaW1hdGlvbkJ1aWxkZXJcbiAgKSB7IH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMub3ZlcmxheS5zaG93KHRoaXMucHJpb3JpdHkpO1xuXG4gICAgdGhpcy5kaWFsb2dTdGF0ZSA9IHRoaXMudmVydGljYWxBbGlnbjtcbiAgICBpZiAodGhpcy5kdXJhdGlvbikge1xuICAgICAgdGhpcy5iYXIuc2hyaW5rSW4odGhpcy5kdXJhdGlvbik7XG4gICAgfVxuICB9XG5cbiAgZG9uZVNocmlua2luZygpIHtcbiAgICB0aGlzLmZpdkR1cmF0aW9uT3Zlci5lbWl0KHRoaXMpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5kaWFsb2dTdGF0ZSA9ICdvdXQnO1xuICAgIHRoaXMuYmFyLnN0b3BQcm9ncmVzc0FuaW1hdGlvbigpO1xuICB9XG5cbiAgYmFja2Ryb3BDbGljaygpIHtcbiAgICBpZiAodGhpcy5iYWNrZHJvcERpc21pc3MpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICBhbmltYXRpb25Eb25lKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmZyb21TdGF0ZSAhPT0gJ3ZvaWQnICYmIGV2ZW50LnRvU3RhdGUgPT09ICdvdXQnKSB7XG4gICAgICB0aGlzLnRyYW5zZm9ybURpYWxvZygwKTtcbiAgICAgIHRoaXMub3ZlcmxheS5oaWRlKCk7XG4gICAgICB0aGlzLmZpdkNsb3NlLmVtaXQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgYmFja2Ryb3BBbmltRG9uZShldmVudCkge1xuICAgIGlmIChldmVudC5mcm9tU3RhdGUgPT09ICdvdXQnICYmIGV2ZW50LnRvU3RhdGUgIT09ICd2b2lkJykge1xuICAgICAgdGhpcy5maXZPcGVuLmVtaXQodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgb25SZWZyZXNoKCkge1xuICAgIHRoaXMuY2xvc2UoKTtcbiAgfVxuXG4gIGZpdkNhbmNlbCgpIHtcbiAgICB0aGlzLnJlc2V0RGlhbG9nKHRoaXMuY3VycmVudFB1bGxQcm9ncmVzcyk7XG4gIH1cblxuICB0cmFuc2Zvcm1EaWFsb2cocHJvZ3Jlc3M6IG51bWJlcikge1xuICAgIHRoaXMuY3VycmVudFB1bGxQcm9ncmVzcyA9IHByb2dyZXNzO1xuICAgIHRoaXMuZG9tQ3RybC53cml0ZSgoKSA9PiB7XG4gICAgICBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAnYm90dG9tJykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgJ21hcmdpbi1ib3R0b20nLFxuICAgICAgICAgIGAtJHtwcm9ncmVzcyAqIDEyMH1weGBcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAndG9wJykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgJ21hcmdpbi10b3AnLFxuICAgICAgICAgIGAtJHtwcm9ncmVzcyAqIDEyMH1weGBcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAnY2VudGVyJykge1xuICAgICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICAgIHRoaXMuZGlhbG9nUmVmLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICAgJ21hcmdpbi10b3AnLFxuICAgICAgICAgIGAke3Byb2dyZXNzICogMTIwfXB4YFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmVzZXREaWFsb2cocHJvZ3Jlc3M6IG51bWJlcikge1xuICAgIGxldCByZXNldDtcbiAgICBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAnYm90dG9tJykge1xuICAgICAgcmVzZXQgPSB0aGlzLmFuaW1hdGlvbi5idWlsZChbXG4gICAgICAgIHN0eWxlKHsgJ21hcmdpbi1ib3R0b20nOiBgLSR7cHJvZ3Jlc3MgKiAxMjB9cHhgIH0pLFxuICAgICAgICBhbmltYXRlKCcxNTBtcycsIHN0eWxlKHsgJ21hcmdpbi1ib3R0b20nOiBgMHB4YCB9KSlcbiAgICAgIF0pO1xuICAgIH0gZWxzZSBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAndG9wJykge1xuICAgICAgcmVzZXQgPSB0aGlzLmFuaW1hdGlvbi5idWlsZChbXG4gICAgICAgIHN0eWxlKHsgJ21hcmdpbi10b3AnOiBgLSR7cHJvZ3Jlc3MgKiAxMjB9cHhgIH0pLFxuICAgICAgICBhbmltYXRlKCcxNTBtcycsIHN0eWxlKHsgJ21hcmdpbi10b3AnOiBgMHB4YCB9KSlcbiAgICAgIF0pO1xuICAgIH0gZWxzZSBpZiAodGhpcy52ZXJ0aWNhbEFsaWduID09PSAnY2VudGVyJykge1xuICAgICAgcmVzZXQgPSB0aGlzLmFuaW1hdGlvbi5idWlsZChbXG4gICAgICAgIHN0eWxlKHsgJ21hcmdpbi10b3AnOiBgJHtwcm9ncmVzcyAqIDEyMH1weGAgfSksXG4gICAgICAgIGFuaW1hdGUoJzE1MG1zJywgc3R5bGUoeyAnbWFyZ2luLXRvcCc6IGAwcHhgIH0pKVxuICAgICAgXSk7XG4gICAgfVxuXG4gICAgY29uc3QgYW5pbWF0aW9uID0gcmVzZXQuY3JlYXRlKHRoaXMuZGlhbG9nUmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgIGFuaW1hdGlvbi5wbGF5KCk7XG4gICAgYW5pbWF0aW9uLm9uRG9uZSgoKSA9PiB7XG4gICAgICBhbmltYXRpb24uZGVzdHJveSgpO1xuICAgICAgdGhpcy50cmFuc2Zvcm1EaWFsb2coMCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdfQ==