/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Platform } from '@ionic/angular';
import { Component, ViewChild, ElementRef, Renderer2, Output, EventEmitter } from '@angular/core';
import { trigger, transition, animate, style } from '@angular/animations';
var FivFeatureDiscovery = /** @class */ (function () {
    function FivFeatureDiscovery(renderer, platform) {
        this.renderer = renderer;
        this.platform = platform;
        this.top = 0;
        this.left = 0;
        this.width = 420;
        this.height = 420;
        this.innerDiameter = 0;
        this.featurePadding = 0;
        this.contentTop = 0;
        this.contentLeft = 0;
        this.contentWidth = 0;
        this.contentHeight = 0;
        this.contentOffset = 0;
        this.animationState = 'hidden';
        this.pulse = 'small';
        this.fivClick = new EventEmitter();
        this.fivBackdropClick = new EventEmitter();
        this.fivClose = new EventEmitter();
        this.fivOpen = new EventEmitter();
        this.fivAnimation = new EventEmitter();
    }
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.ngOnInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.ngAfterContentInit = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?} bounds
     * @return {?}
     */
    FivFeatureDiscovery.prototype.setBounds = /**
     * @param {?} bounds
     * @return {?}
     */
    function (bounds) {
        this.bounds = bounds;
        this.innerDiameter =
            bounds.height > bounds.width ? bounds.height : bounds.width;
        this.top = bounds.top + bounds.height / 2 - this.height / 2;
        this.left = bounds.left + bounds.width / 2 - this.width / 2;
        this.calculateContentBounds();
        if (!this.icon) {
            // tslint:disable-next-line:max-line-length
            /** @type {?} */
            var gradient = "-webkit-radial-gradient(transparent " + (this
                .innerDiameter /
                2 +
                5) + "px, var(--fiv-color-feature) " + (this.innerDiameter / 2 + 5) + "px)";
            // tslint:disable-next-line:max-line-length
            /** @type {?} */
            var pulseGradient = "-webkit-radial-gradient(transparent " + (this
                .innerDiameter /
                2 +
                5) + "px, var(--fiv-color-pulse) " + (this.innerDiameter / 2 + 5) + "px)";
            this.renderer.setStyle(this.circle.nativeElement, 'background', gradient);
            this.renderer.setStyle(this.innerPulse.nativeElement, 'background', pulseGradient);
            this.renderer.setStyle(this.outerPulse.nativeElement, 'background', pulseGradient);
        }
    };
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.calculateContentBounds = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var absoluteCenter = {
            x: this.platform.width() / 2,
            y: this.platform.height() / 2
        };
        /** @type {?} */
        var center = {
            x: this.left + this.width / 2,
            y: this.top + this.width / 2
        };
        /** @type {?} */
        var rectWidth = Math.sqrt(Math.pow(this.width, 2) / 2);
        /** @type {?} */
        var isTop = center.y < absoluteCenter.y;
        /** @type {?} */
        var isLeft = center.x < absoluteCenter.x;
        /** @type {?} */
        var innerRadius = this.innerDiameter / 2;
        /** @type {?} */
        var padding = this.featurePadding / 2;
        /** @type {?} */
        var contentRight = 0;
        /** @type {?} */
        var contentBottom = 0;
        if (isLeft) {
            this.contentLeft = center.x - innerRadius;
            contentRight = Math.min(center.x + rectWidth / 2 + this.contentOffset, this.platform.width());
        }
        else {
            this.contentLeft = Math.max(center.x - rectWidth / 2 - this.contentOffset, 0);
            contentRight = center.x + innerRadius;
        }
        if (isTop) {
            this.contentTop = center.y + innerRadius + padding;
            contentBottom = center.y + rectWidth / 2 + -1 * this.contentOffset;
        }
        else {
            this.contentTop = center.y - rectWidth / 2 + this.contentOffset;
            contentBottom = center.y - innerRadius - padding;
        }
        this.contentWidth = Math.abs(this.contentLeft - contentRight);
        this.contentHeight = Math.abs(this.contentTop - contentBottom);
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FivFeatureDiscovery.prototype.handleCircleAnimation = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        this.fivAnimation.emit(event);
        if (event.toState === 'visible') {
            this.fivOpen.emit();
        }
        if (event.fromState === 'visible' && event.toState === 'hidden') {
            this.fivClose.emit();
        }
        if (event.fromState === 'visible' && event.toState === 'execute') {
            this.fivClose.emit();
        }
    };
    /**
     * @param {?} event
     * @return {?}
     */
    FivFeatureDiscovery.prototype.handleFeatureAnimation = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        if (event.toState === 'big') {
            this.pulse = 'small';
        }
        if (event.toState === 'small') {
            this.pulse = 'big';
        }
    };
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.show = /**
     * @return {?}
     */
    function () {
        this.animationState = 'visible';
    };
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.hide = /**
     * @return {?}
     */
    function () {
        this.animationState = 'hidden';
    };
    /**
     * @return {?}
     */
    FivFeatureDiscovery.prototype.featureClick = /**
     * @return {?}
     */
    function () {
        this.animationState = 'execute';
    };
    /**
     * @param {?} icon
     * @return {?}
     */
    FivFeatureDiscovery.prototype.setIcon = /**
     * @param {?} icon
     * @return {?}
     */
    function (icon) {
        if (icon) {
            this.icon = icon.name;
        }
    };
    FivFeatureDiscovery.decorators = [
        { type: Component, args: [{
                    selector: 'fiv-feature-discovery',
                    template: "<div class=\"backdrop\" (click)=\"fivBackdropClick.emit()\"></div>\n<div [@scale]=\"animationState\" (@scale.done)=\"handleCircleAnimation($event)\" #circle class=\"circle\"\n  [style.height]=\"height + 'px'\" [style.width]=\"width + 'px'\" [style.top]=\"top + 'px'\" [style.left]=\"left + 'px'\">\n  <div #pOuter class=\"feature center\" [@pulseFade]=\"pulse\" [style.height]=\"(innerDiameter + featurePadding) + 'px'\"\n    [style.width]=\"(innerDiameter + featurePadding) + 'px'\">\n  </div>\n  <fiv-ripple #pInner class=\"feature center\" (fivClick)=\"fivClick.emit()\" [@pulse]=\"pulse\"\n    (@pulse.done)=\"handleFeatureAnimation($event)\" [style.height]=\"(innerDiameter + (icon ? featurePadding : 0)) + 'px'\"\n    [style.width]=\"(innerDiameter + (icon ? featurePadding : 0)) + 'px'\">\n    <fiv-icon class=\"center\" *ngIf=\"icon\" [name]=\"icon\"></fiv-icon>\n  </fiv-ripple>\n</div>\n<div class=\"content\" *ngIf=\"animationState === 'visible'\" [@contentAnim] [style.width]=\"contentWidth + 'px'\"\n  [style.height]=\"contentHeight + 'px'\" [style.top]=\"contentTop + 'px'\" [style.left]=\"contentLeft + 'px'\">\n  <ng-content></ng-content>\n</div>",
                    animations: [
                        trigger('scale', [
                            transition('* => visible', [
                                style({ transform: 'scale(0)', opacity: '0' }),
                                animate('240ms ease-out', style({ transform: 'scale(1)', opacity: '1' }))
                            ]),
                            transition('visible => hidden', [
                                style({ transform: 'scale(1)', opacity: '1' }),
                                animate('215ms ease-in', style({ transform: 'scale(0)', opacity: '0' }))
                            ]),
                            transition('visible => execute', [
                                style({ transform: 'scale(1)', opacity: '1' }),
                                animate('215ms 0.15s ease-in', style({ transform: 'scale(1.4)', opacity: '0' }))
                            ])
                        ]),
                        trigger('pulse', [
                            transition('small => big', [
                                style({ transform: 'scale(1) translate(-50%,-50%)' }),
                                animate('1000ms', style({ transform: 'scale(1.1) translate(-45%,-45%)' }))
                            ]),
                            transition('big => small', [
                                style({ transform: 'scale(1.1) translate(-45%,-45%)' }),
                                animate('400ms', style({ transform: 'scale(1) translate(-50%,-50%)' }))
                            ])
                        ]),
                        trigger('pulseFade', [
                            transition('small => big', [
                                style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0.8 }),
                                animate('1000ms', style({ transform: 'scale(1.6) translate(-28%,-28%)', opacity: 0 }))
                            ]),
                            transition('big => small', [
                                style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0 }),
                                animate('400ms', style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0 }))
                            ])
                        ]),
                        trigger('contentAnim', [
                            transition('void => *', [
                                style({ opacity: '0' }),
                                animate('100ms 240ms ease-out', style({ opacity: '1' }))
                            ])
                        ])
                    ],
                    styles: [":host{display:block;height:100vh;width:100vw;position:absolute;--fiv-color-feature:rgba(56, 128, 255, 0.97);--fiv-color-pulse:var(--ion-color-light)}.backdrop{display:block;height:100vh;width:100vw;position:absolute}fiv-icon{--fiv-color-icon:var(--ion-color-primary)}.circle{position:absolute;border-radius:100%;background:var(--fiv-color-feature);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.feature{border-radius:100%;background:var(--fiv-color-pulse)}.content{position:absolute}.center{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"]
                }] }
    ];
    /** @nocollapse */
    FivFeatureDiscovery.ctorParameters = function () { return [
        { type: Renderer2 },
        { type: Platform }
    ]; };
    FivFeatureDiscovery.propDecorators = {
        circle: [{ type: ViewChild, args: ['circle',] }],
        rect: [{ type: ViewChild, args: ['rect',] }],
        innerPulse: [{ type: ViewChild, args: ['pInner', { read: ElementRef },] }],
        outerPulse: [{ type: ViewChild, args: ['pOuter',] }],
        fivClick: [{ type: Output }],
        fivBackdropClick: [{ type: Output }],
        fivClose: [{ type: Output }],
        fivOpen: [{ type: Output }],
        fivAnimation: [{ type: Output }]
    };
    return FivFeatureDiscovery;
}());
export { FivFeatureDiscovery };
if (false) {
    /** @type {?} */
    FivFeatureDiscovery.prototype.top;
    /** @type {?} */
    FivFeatureDiscovery.prototype.left;
    /** @type {?} */
    FivFeatureDiscovery.prototype.width;
    /** @type {?} */
    FivFeatureDiscovery.prototype.height;
    /** @type {?} */
    FivFeatureDiscovery.prototype.innerDiameter;
    /** @type {?} */
    FivFeatureDiscovery.prototype.featurePadding;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentTop;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentLeft;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentWidth;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentHeight;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentOffset;
    /** @type {?} */
    FivFeatureDiscovery.prototype.bounds;
    /** @type {?} */
    FivFeatureDiscovery.prototype.icon;
    /** @type {?} */
    FivFeatureDiscovery.prototype.circle;
    /** @type {?} */
    FivFeatureDiscovery.prototype.rect;
    /** @type {?} */
    FivFeatureDiscovery.prototype.innerPulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.outerPulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.animationState;
    /** @type {?} */
    FivFeatureDiscovery.prototype.pulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivClick;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivBackdropClick;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivClose;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivOpen;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivAnimation;
    /**
     * @type {?}
     * @private
     */
    FivFeatureDiscovery.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FivFeatureDiscovery.prototype.platform;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVhdHVyZS1kaXNjb3ZlcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZpdmV0aHJlZS9jb3JlLyIsInNvdXJjZXMiOlsibGliL2ZlYXR1cmUtZGlzY292ZXJ5L2ZlYXR1cmUtZGlzY292ZXJ5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFDTCxTQUFTLEVBRVQsU0FBUyxFQUVULFVBQVUsRUFDVixTQUFTLEVBQ1QsTUFBTSxFQUNOLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBRUwsT0FBTyxFQUNQLFVBQVUsRUFDVixPQUFPLEVBQ1AsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFJN0I7SUEwRkUsNkJBQW9CLFFBQW1CLEVBQVUsUUFBa0I7UUFBL0MsYUFBUSxHQUFSLFFBQVEsQ0FBVztRQUFVLGFBQVEsR0FBUixRQUFRLENBQVU7UUEzQm5FLFFBQUcsR0FBRyxDQUFDLENBQUM7UUFDUixTQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ1QsVUFBSyxHQUFHLEdBQUcsQ0FBQztRQUNaLFdBQU0sR0FBRyxHQUFHLENBQUM7UUFDYixrQkFBYSxHQUFHLENBQUMsQ0FBQztRQUNsQixtQkFBYyxHQUFHLENBQUMsQ0FBQztRQUNuQixlQUFVLEdBQUcsQ0FBQyxDQUFDO1FBQ2YsZ0JBQVcsR0FBRyxDQUFDLENBQUM7UUFDaEIsaUJBQVksR0FBRyxDQUFDLENBQUM7UUFDakIsa0JBQWEsR0FBRyxDQUFDLENBQUM7UUFDbEIsa0JBQWEsR0FBRyxDQUFDLENBQUM7UUFRbEIsbUJBQWMsR0FBRyxRQUFRLENBQUM7UUFDMUIsVUFBSyxHQUFHLE9BQU8sQ0FBQztRQUVOLGFBQVEsR0FBRyxJQUFJLFlBQVksRUFBTyxDQUFDO1FBQ25DLHFCQUFnQixHQUFHLElBQUksWUFBWSxFQUFPLENBQUM7UUFDM0MsYUFB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QUFROzs7eUJBaUdkLFNBQVMsU0FBQyxRQUFRO3VCQUNsQixTQUFTLFNBQUMsTUFBTTs2QkFDaEIsU0FBUyxTQUFDLFFBQVEsRUFBRSxFQUFFLElBQUksRUFBRSxVQUFVLEVBQUU7NkJBQ3hDLFNBQVMsU0FBQyxRQUFROzJCQUtsQixNQUFNO21DQUNOLE1BQU07MkJBQ04sTUFBTTswQkFDTixNQUFNOytCQUNOLE1BQU07O0lBcUhULDBCQUFDO0NBQUEsQUE3TUQsSUE2TUM7U0EvSVksbUJBQW1COzs7SUFDOUIsa0NBQVE7O0lBQ1IsbUNBQVM7O0lBQ1Qsb0NBQVk7O0lBQ1oscUNBQWE7O0lBQ2IsNENBQWtCOztJQUNsQiw2Q0FBbUI7O0lBQ25CLHlDQUFlOztJQUNmLDBDQUFnQjs7SUFDaEIsMkNBQWlCOztJQUNqQiw0Q0FBa0I7O0lBQ2xCLDRDQUFrQjs7SUFDbEIscUNBQXdCOztJQUN4QixtQ0FBYTs7SUFDYixxQ0FBd0M7O0lBQ3hDLG1DQUFvQzs7SUFDcEMseUNBQWtFOztJQUNsRSx5Q0FBNEM7O0lBRTVDLDZDQUEwQjs7SUFDMUIsb0NBQWdCOztJQUVoQix1Q0FBNkM7O0lBQzdDLCtDQUFxRDs7SUFDckQsdUNBQTZDOztJQUM3QyxzQ0FBNEM7O0lBQzVDLDJDQUE0RDs7Ozs7SUFFaEQsdUNBQTJCOzs7OztJQUFFLHVDQUEwQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBsYXRmb3JtIH0gZnJvbSAnQGlvbmljL2FuZ3VsYXInO1xuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBPbkluaXQsXG4gIFZpZXdDaGlsZCxcbiAgQWZ0ZXJDb250ZW50SW5pdCxcbiAgRWxlbWVudFJlZixcbiAgUmVuZGVyZXIyLFxuICBPdXRwdXQsXG4gIEV2ZW50RW1pdHRlclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7XG4gIEFuaW1hdGlvbkV2ZW50LFxuICB0cmlnZ2VyLFxuICB0cmFuc2l0aW9uLFxuICBhbmltYXRlLFxuICBzdHlsZVxufSBmcm9tICdAYW5ndWxhci9hbmltYXRpb25zJztcbmltcG9ydCB7IEZlYXR1cmVQb3NpdGlvbiB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgRml2SWNvbiB9IGZyb20gJy4uL2ljb24vaWNvbi5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdmaXYtZmVhdHVyZS1kaXNjb3ZlcnknLFxuICB0ZW1wbGF0ZVVybDogJy4vZmVhdHVyZS1kaXNjb3ZlcnkuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9mZWF0dXJlLWRpc2NvdmVyeS5jb21wb25lbnQuc2NzcyddLFxuICBhbmltYXRpb25zOiBbXG4gICAgdHJpZ2dlcignc2NhbGUnLCBbXG4gICAgICB0cmFuc2l0aW9uKCcqID0+IHZpc2libGUnLCBbXG4gICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMCknLCBvcGFjaXR5OiAnMCcgfSksXG4gICAgICAgIGFuaW1hdGUoXG4gICAgICAgICAgJzI0MG1zIGVhc2Utb3V0JyxcbiAgICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpJywgb3BhY2l0eTogJzEnIH0pXG4gICAgICAgIClcbiAgICAgIF0pLFxuICAgICAgdHJhbnNpdGlvbigndmlzaWJsZSA9PiBoaWRkZW4nLCBbXG4gICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMSknLCBvcGFjaXR5OiAnMScgfSksXG4gICAgICAgIGFuaW1hdGUoJzIxNW1zIGVhc2UtaW4nLCBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDApJywgb3BhY2l0eTogJzAnIH0pKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCd2aXNpYmxlID0+IGV4ZWN1dGUnLCBbXG4gICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMSknLCBvcGFjaXR5OiAnMScgfSksXG4gICAgICAgIGFuaW1hdGUoXG4gICAgICAgICAgJzIxNW1zIDAuMTVzIGVhc2UtaW4nLFxuICAgICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMS40KScsIG9wYWNpdHk6ICcwJyB9KVxuICAgICAgICApXG4gICAgICBdKVxuICAgIF0pLFxuICAgIHRyaWdnZXIoJ3B1bHNlJywgW1xuICAgICAgdHJhbnNpdGlvbignc21hbGwgPT4gYmlnJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpJyB9KSxcbiAgICAgICAgYW5pbWF0ZShcbiAgICAgICAgICAnMTAwMG1zJyxcbiAgICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEuMSkgdHJhbnNsYXRlKC00NSUsLTQ1JSknIH0pXG4gICAgICAgIClcbiAgICAgIF0pLFxuICAgICAgdHJhbnNpdGlvbignYmlnID0+IHNtYWxsJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEuMSkgdHJhbnNsYXRlKC00NSUsLTQ1JSknIH0pLFxuICAgICAgICBhbmltYXRlKCc0MDBtcycsIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSknIH0pKVxuICAgICAgXSlcbiAgICBdKSxcbiAgICB0cmlnZ2VyKCdwdWxzZUZhZGUnLCBbXG4gICAgICB0cmFuc2l0aW9uKCdzbWFsbCA9PiBiaWcnLCBbXG4gICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSknLCBvcGFjaXR5OiAwLjggfSksXG4gICAgICAgIGFuaW1hdGUoXG4gICAgICAgICAgJzEwMDBtcycsXG4gICAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxLjYpIHRyYW5zbGF0ZSgtMjglLC0yOCUpJywgb3BhY2l0eTogMCB9KVxuICAgICAgICApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJ2JpZyA9PiBzbWFsbCcsIFtcbiAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKScsIG9wYWNpdHk6IDAgfSksXG4gICAgICAgIGFuaW1hdGUoXG4gICAgICAgICAgJzQwMG1zJyxcbiAgICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpJywgb3BhY2l0eTogMCB9KVxuICAgICAgICApXG4gICAgICBdKVxuICAgIF0pLFxuICAgIHRyaWdnZXIoJ2NvbnRlbnRBbmltJywgW1xuICAgICAgdHJhbnNpdGlvbigndm9pZCA9PiAqJywgW1xuICAgICAgICBzdHlsZSh7IG9wYWNpdHk6ICcwJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnMTAwbXMgMjQwbXMgZWFzZS1vdXQnLCBzdHlsZSh7IG9wYWNpdHk6ICcxJyB9KSlcbiAgICAgIF0pXG4gICAgXSlcbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBGaXZGZWF0dXJlRGlzY292ZXJ5IGltcGxlbWVudHMgT25Jbml0LCBBZnRlckNvbnRlbnRJbml0IHtcbiAgdG9wID0gMDtcbiAgbGVmdCA9IDA7XG4gIHdpZHRoID0gNDIwO1xuICBoZWlnaHQgPSA0MjA7XG4gIGlubmVyRGlhbWV0ZXIgPSAwO1xuICBmZWF0dXJlUGFkZGluZyA9IDA7XG4gIGNvbnRlbnRUb3AgPSAwO1xuICBjb250ZW50TGVmdCA9IDA7XG4gIGNvbnRlbnRXaWR0aCA9IDA7XG4gIGNvbnRlbnRIZWlnaHQgPSAwO1xuICBjb250ZW50T2Zmc2V0ID0gMDtcbiAgYm91bmRzOiBGZWF0dXJlUG9zaXRpb247XG4gIGljb246IHN0cmluZztcbiAgQFZpZXdDaGlsZCgnY2lyY2xlJykgY2lyY2xlOiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKCdyZWN0JykgcmVjdDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgncElubmVyJywgeyByZWFkOiBFbGVtZW50UmVmIH0pIGlubmVyUHVsc2U6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ3BPdXRlcicpIG91dGVyUHVsc2U6IEVsZW1lbnRSZWY7XG5cbiAgYW5pbWF0aW9uU3RhdGUgPSAnaGlkZGVuJztcbiAgcHVsc2UgPSAnc21hbGwnO1xuXG4gIEBPdXRwdXQoKSBmaXZDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBAT3V0cHV0KCkgZml2QmFja2Ryb3BDbGljayA9IG5ldyBFdmVudEVtaXR0ZXI8YW55PigpO1xuICBAT3V0cHV0KCkgZml2Q2xvc2UgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIGZpdk9wZW4gPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIGZpdkFuaW1hdGlvbiA9IG5ldyBFdmVudEVtaXR0ZXI8QW5pbWF0aW9uRXZlbnQ+KCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZW5kZXJlcjogUmVuZGVyZXIyLCBwcml2YXRlIHBsYXRmb3JtOiBQbGF0Zm9ybSkge31cblxuICBuZ09uSW5pdCgpIHt9XG5cbiAgbmdBZnRlckNvbnRlbnRJbml0KCk6IHZvaWQge31cblxuICBzZXRCb3VuZHMoYm91bmRzOiBGZWF0dXJlUG9zaXRpb24pIHtcbiAgICB0aGlzLmJvdW5kcyA9IGJvdW5kcztcbiAgICB0aGlzLmlubmVyRGlhbWV0ZXIgPVxuICAgICAgYm91bmRzLmhlaWdodCA+IGJvdW5kcy53aWR0aCA/IGJvdW5kcy5oZWlnaHQgOiBib3VuZHMud2lkdGg7XG4gICAgdGhpcy50b3AgPSBib3VuZHMudG9wICsgYm91bmRzLmhlaWdodCAvIDIgLSB0aGlzLmhlaWdodCAvIDI7XG4gICAgdGhpcy5sZWZ0ID0gYm91bmRzLmxlZnQgKyBib3VuZHMud2lkdGggLyAyIC0gdGhpcy53aWR0aCAvIDI7XG4gICAgdGhpcy5jYWxjdWxhdGVDb250ZW50Qm91bmRzKCk7XG4gICAgaWYgKCF0aGlzLmljb24pIHtcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbiAgICAgIGNvbnN0IGdyYWRpZW50ID0gYC13ZWJraXQtcmFkaWFsLWdyYWRpZW50KHRyYW5zcGFyZW50ICR7dGhpc1xuICAgICAgICAuaW5uZXJEaWFtZXRlciAvXG4gICAgICAgIDIgK1xuICAgICAgICA1fXB4LCB2YXIoLS1maXYtY29sb3ItZmVhdHVyZSkgJHt0aGlzLmlubmVyRGlhbWV0ZXIgLyAyICsgNX1weClgO1xuICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1saW5lLWxlbmd0aFxuICAgICAgY29uc3QgcHVsc2VHcmFkaWVudCA9IGAtd2Via2l0LXJhZGlhbC1ncmFkaWVudCh0cmFuc3BhcmVudCAke3RoaXNcbiAgICAgICAgLmlubmVyRGlhbWV0ZXIgL1xuICAgICAgICAyICtcbiAgICAgICAgNX1weCwgdmFyKC0tZml2LWNvbG9yLXB1bHNlKSAke3RoaXMuaW5uZXJEaWFtZXRlciAvIDIgKyA1fXB4KWA7XG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKHRoaXMuY2lyY2xlLm5hdGl2ZUVsZW1lbnQsICdiYWNrZ3JvdW5kJywgZ3JhZGllbnQpO1xuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZShcbiAgICAgICAgdGhpcy5pbm5lclB1bHNlLm5hdGl2ZUVsZW1lbnQsXG4gICAgICAgICdiYWNrZ3JvdW5kJyxcbiAgICAgICAgcHVsc2VHcmFkaWVudFxuICAgICAgKTtcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgIHRoaXMub3V0ZXJQdWxzZS5uYXRpdmVFbGVtZW50LFxuICAgICAgICAnYmFja2dyb3VuZCcsXG4gICAgICAgIHB1bHNlR3JhZGllbnRcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIGNhbGN1bGF0ZUNvbnRlbnRCb3VuZHMoKSB7XG4gICAgY29uc3QgYWJzb2x1dGVDZW50ZXI6IHsgeDogbnVtYmVyOyB5OiBudW1iZXIgfSA9IHtcbiAgICAgIHg6IHRoaXMucGxhdGZvcm0ud2lkdGgoKSAvIDIsXG4gICAgICB5OiB0aGlzLnBsYXRmb3JtLmhlaWdodCgpIC8gMlxuICAgIH07XG4gICAgY29uc3QgY2VudGVyOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0gPSB7XG4gICAgICB4OiB0aGlzLmxlZnQgKyB0aGlzLndpZHRoIC8gMixcbiAgICAgIHk6IHRoaXMudG9wICsgdGhpcy53aWR0aCAvIDJcbiAgICB9O1xuICAgIGNvbnN0IHJlY3RXaWR0aCA9IE1hdGguc3FydChNYXRoLnBvdyh0aGlzLndpZHRoLCAyKSAvIDIpO1xuICAgIGNvbnN0IGlzVG9wID0gY2VudGVyLnkgPCBhYnNvbHV0ZUNlbnRlci55O1xuICAgIGNvbnN0IGlzTGVmdCA9IGNlbnRlci54IDwgYWJzb2x1dGVDZW50ZXIueDtcbiAgICBjb25zdCBpbm5lclJhZGl1cyA9IHRoaXMuaW5uZXJEaWFtZXRlciAvIDI7XG4gICAgY29uc3QgcGFkZGluZyA9IHRoaXMuZmVhdHVyZVBhZGRpbmcgLyAyO1xuICAgIGxldCBjb250ZW50UmlnaHQgPSAwO1xuICAgIGxldCBjb250ZW50Qm90dG9tID0gMDtcbiAgICBpZiAoaXNMZWZ0KSB7XG4gICAgICB0aGlzLmNvbnRlbnRMZWZ0ID0gY2VudGVyLnggLSBpbm5lclJhZGl1cztcbiAgICAgIGNvbnRlbnRSaWdodCA9IE1hdGgubWluKFxuICAgICAgICBjZW50ZXIueCArIHJlY3RXaWR0aCAvIDIgKyB0aGlzLmNvbnRlbnRPZmZzZXQsXG4gICAgICAgIHRoaXMucGxhdGZvcm0ud2lkdGgoKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb250ZW50TGVmdCA9IE1hdGgubWF4KFxuICAgICAgICBjZW50ZXIueCAtIHJlY3RXaWR0aCAvIDIgLSB0aGlzLmNvbnRlbnRPZmZzZXQsXG4gICAgICAgIDBcbiAgICAgICk7XG4gICAgICBjb250ZW50UmlnaHQgPSBjZW50ZXIueCArIGlubmVyUmFkaXVzO1xuICAgIH1cbiAgICBpZiAoaXNUb3ApIHtcbiAgICAgIHRoaXMuY29udGVudFRvcCA9IGNlbnRlci55ICsgaW5uZXJSYWRpdXMgKyBwYWRkaW5nO1xuICAgICAgY29udGVudEJvdHRvbSA9IGNlbnRlci55ICsgcmVjdFdpZHRoIC8gMiArIC0xICogdGhpcy5jb250ZW50T2Zmc2V0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmNvbnRlbnRUb3AgPSBjZW50ZXIueSAtIHJlY3RXaWR0aCAvIDIgKyB0aGlzLmNvbnRlbnRPZmZzZXQ7XG4gICAgICBjb250ZW50Qm90dG9tID0gY2VudGVyLnkgLSBpbm5lclJhZGl1cyAtIHBhZGRpbmc7XG4gICAgfVxuXG4gICAgdGhpcy5jb250ZW50V2lkdGggPSBNYXRoLmFicyh0aGlzLmNvbnRlbnRMZWZ0IC0gY29udGVudFJpZ2h0KTtcbiAgICB0aGlzLmNvbnRlbnRIZWlnaHQgPSBNYXRoLmFicyh0aGlzLmNvbnRlbnRUb3AgLSBjb250ZW50Qm90dG9tKTtcbiAgfVxuICBoYW5kbGVDaXJjbGVBbmltYXRpb24oZXZlbnQ6IEFuaW1hdGlvbkV2ZW50KSB7XG4gICAgdGhpcy5maXZBbmltYXRpb24uZW1pdChldmVudCk7XG4gICAgaWYgKGV2ZW50LnRvU3RhdGUgPT09ICd2aXNpYmxlJykge1xuICAgICAgdGhpcy5maXZPcGVuLmVtaXQoKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmZyb21TdGF0ZSA9PT0gJ3Zpc2libGUnICYmIGV2ZW50LnRvU3RhdGUgPT09ICdoaWRkZW4nKSB7XG4gICAgICB0aGlzLmZpdkNsb3NlLmVtaXQoKTtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmZyb21TdGF0ZSA9PT0gJ3Zpc2libGUnICYmIGV2ZW50LnRvU3RhdGUgPT09ICdleGVjdXRlJykge1xuICAgICAgdGhpcy5maXZDbG9zZS5lbWl0KCk7XG4gICAgfVxuICB9XG4gIGhhbmRsZUZlYXR1cmVBbmltYXRpb24oZXZlbnQ6IEFuaW1hdGlvbkV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnRvU3RhdGUgPT09ICdiaWcnKSB7XG4gICAgICB0aGlzLnB1bHNlID0gJ3NtYWxsJztcbiAgICB9XG4gICAgaWYgKGV2ZW50LnRvU3RhdGUgPT09ICdzbWFsbCcpIHtcbiAgICAgIHRoaXMucHVsc2UgPSAnYmlnJztcbiAgICB9XG4gIH1cblxuICBzaG93KCkge1xuICAgIHRoaXMuYW5pbWF0aW9uU3RhdGUgPSAndmlzaWJsZSc7XG4gIH1cblxuICBoaWRlKCkge1xuICAgIHRoaXMuYW5pbWF0aW9uU3RhdGUgPSAnaGlkZGVuJztcbiAgfVxuXG4gIGZlYXR1cmVDbGljaygpIHtcbiAgICB0aGlzLmFuaW1hdGlvblN0YXRlID0gJ2V4ZWN1dGUnO1xuICB9XG5cbiAgc2V0SWNvbihpY29uOiBGaXZJY29uKSB7XG4gICAgaWYgKGljb24pIHtcbiAgICAgIHRoaXMuaWNvbiA9IGljb24ubmFtZTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==