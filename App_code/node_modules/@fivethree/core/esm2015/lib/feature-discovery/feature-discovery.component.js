/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Platform } from '@ionic/angular';
import { Component, ViewChild, ElementRef, Renderer2, Output, EventEmitter } from '@angular/core';
import { trigger, transition, animate, style } from '@angular/animations';
export class FivFeatureDiscovery {
    /**
     * @param {?} renderer
     * @param {?} platform
     */
    constructor(renderer, platform) {
        this.renderer = renderer;
        this.platform = platform;
        this.top = 0;
        this.left = 0;
        this.width = 420;
        this.height = 420;
        this.innerDiameter = 0;
        this.featurePadding = 0;
        this.contentTop = 0;
        this.contentLeft = 0;
        this.contentWidth = 0;
        this.contentHeight = 0;
        this.contentOffset = 0;
        this.animationState = 'hidden';
        this.pulse = 'small';
        this.fivClick = new EventEmitter();
        this.fivBackdropClick = new EventEmitter();
        this.fivClose = new EventEmitter();
        this.fivOpen = new EventEmitter();
        this.fivAnimation = new EventEmitter();
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @return {?}
     */
    ngAfterContentInit() { }
    /**
     * @param {?} bounds
     * @return {?}
     */
    setBounds(bounds) {
        this.bounds = bounds;
        this.innerDiameter =
            bounds.height > bounds.width ? bounds.height : bounds.width;
        this.top = bounds.top + bounds.height / 2 - this.height / 2;
        this.left = bounds.left + bounds.width / 2 - this.width / 2;
        this.calculateContentBounds();
        if (!this.icon) {
            // tslint:disable-next-line:max-line-length
            /** @type {?} */
            const gradient = `-webkit-radial-gradient(transparent ${this
                .innerDiameter /
                2 +
                5}px, var(--fiv-color-feature) ${this.innerDiameter / 2 + 5}px)`;
            // tslint:disable-next-line:max-line-length
            /** @type {?} */
            const pulseGradient = `-webkit-radial-gradient(transparent ${this
                .innerDiameter /
                2 +
                5}px, var(--fiv-color-pulse) ${this.innerDiameter / 2 + 5}px)`;
            this.renderer.setStyle(this.circle.nativeElement, 'background', gradient);
            this.renderer.setStyle(this.innerPulse.nativeElement, 'background', pulseGradient);
            this.renderer.setStyle(this.outerPulse.nativeElement, 'background', pulseGradient);
        }
    }
    /**
     * @return {?}
     */
    calculateContentBounds() {
        /** @type {?} */
        const absoluteCenter = {
            x: this.platform.width() / 2,
            y: this.platform.height() / 2
        };
        /** @type {?} */
        const center = {
            x: this.left + this.width / 2,
            y: this.top + this.width / 2
        };
        /** @type {?} */
        const rectWidth = Math.sqrt(Math.pow(this.width, 2) / 2);
        /** @type {?} */
        const isTop = center.y < absoluteCenter.y;
        /** @type {?} */
        const isLeft = center.x < absoluteCenter.x;
        /** @type {?} */
        const innerRadius = this.innerDiameter / 2;
        /** @type {?} */
        const padding = this.featurePadding / 2;
        /** @type {?} */
        let contentRight = 0;
        /** @type {?} */
        let contentBottom = 0;
        if (isLeft) {
            this.contentLeft = center.x - innerRadius;
            contentRight = Math.min(center.x + rectWidth / 2 + this.contentOffset, this.platform.width());
        }
        else {
            this.contentLeft = Math.max(center.x - rectWidth / 2 - this.contentOffset, 0);
            contentRight = center.x + innerRadius;
        }
        if (isTop) {
            this.contentTop = center.y + innerRadius + padding;
            contentBottom = center.y + rectWidth / 2 + -1 * this.contentOffset;
        }
        else {
            this.contentTop = center.y - rectWidth / 2 + this.contentOffset;
            contentBottom = center.y - innerRadius - padding;
        }
        this.contentWidth = Math.abs(this.contentLeft - contentRight);
        this.contentHeight = Math.abs(this.contentTop - contentBottom);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleCircleAnimation(event) {
        this.fivAnimation.emit(event);
        if (event.toState === 'visible') {
            this.fivOpen.emit();
        }
        if (event.fromState === 'visible' && event.toState === 'hidden') {
            this.fivClose.emit();
        }
        if (event.fromState === 'visible' && event.toState === 'execute') {
            this.fivClose.emit();
        }
    }
    /**
     * @param {?} event
     * @return {?}
     */
    handleFeatureAnimation(event) {
        if (event.toState === 'big') {
            this.pulse = 'small';
        }
        if (event.toState === 'small') {
            this.pulse = 'big';
        }
    }
    /**
     * @return {?}
     */
    show() {
        this.animationState = 'visible';
    }
    /**
     * @return {?}
     */
    hide() {
        this.animationState = 'hidden';
    }
    /**
     * @return {?}
     */
    featureClick() {
        this.animationState = 'execute';
    }
    /**
     * @param {?} icon
     * @return {?}
     */
    setIcon(icon) {
        if (icon) {
            this.icon = icon.name;
        }
    }
}
FivFeatureDiscovery.decorators = [
    { type: Component, args: [{
                selector: 'fiv-feature-discovery',
                template: "<div class=\"backdrop\" (click)=\"fivBackdropClick.emit()\"></div>\n<div [@scale]=\"animationState\" (@scale.done)=\"handleCircleAnimation($event)\" #circle class=\"circle\"\n  [style.height]=\"height + 'px'\" [style.width]=\"width + 'px'\" [style.top]=\"top + 'px'\" [style.left]=\"left + 'px'\">\n  <div #pOuter class=\"feature center\" [@pulseFade]=\"pulse\" [style.height]=\"(innerDiameter + featurePadding) + 'px'\"\n    [style.width]=\"(innerDiameter + featurePadding) + 'px'\">\n  </div>\n  <fiv-ripple #pInner class=\"feature center\" (fivClick)=\"fivClick.emit()\" [@pulse]=\"pulse\"\n    (@pulse.done)=\"handleFeatureAnimation($event)\" [style.height]=\"(innerDiameter + (icon ? featurePadding : 0)) + 'px'\"\n    [style.width]=\"(innerDiameter + (icon ? featurePadding : 0)) + 'px'\">\n    <fiv-icon class=\"center\" *ngIf=\"icon\" [name]=\"icon\"></fiv-icon>\n  </fiv-ripple>\n</div>\n<div class=\"content\" *ngIf=\"animationState === 'visible'\" [@contentAnim] [style.width]=\"contentWidth + 'px'\"\n  [style.height]=\"contentHeight + 'px'\" [style.top]=\"contentTop + 'px'\" [style.left]=\"contentLeft + 'px'\">\n  <ng-content></ng-content>\n</div>",
                animations: [
                    trigger('scale', [
                        transition('* => visible', [
                            style({ transform: 'scale(0)', opacity: '0' }),
                            animate('240ms ease-out', style({ transform: 'scale(1)', opacity: '1' }))
                        ]),
                        transition('visible => hidden', [
                            style({ transform: 'scale(1)', opacity: '1' }),
                            animate('215ms ease-in', style({ transform: 'scale(0)', opacity: '0' }))
                        ]),
                        transition('visible => execute', [
                            style({ transform: 'scale(1)', opacity: '1' }),
                            animate('215ms 0.15s ease-in', style({ transform: 'scale(1.4)', opacity: '0' }))
                        ])
                    ]),
                    trigger('pulse', [
                        transition('small => big', [
                            style({ transform: 'scale(1) translate(-50%,-50%)' }),
                            animate('1000ms', style({ transform: 'scale(1.1) translate(-45%,-45%)' }))
                        ]),
                        transition('big => small', [
                            style({ transform: 'scale(1.1) translate(-45%,-45%)' }),
                            animate('400ms', style({ transform: 'scale(1) translate(-50%,-50%)' }))
                        ])
                    ]),
                    trigger('pulseFade', [
                        transition('small => big', [
                            style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0.8 }),
                            animate('1000ms', style({ transform: 'scale(1.6) translate(-28%,-28%)', opacity: 0 }))
                        ]),
                        transition('big => small', [
                            style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0 }),
                            animate('400ms', style({ transform: 'scale(1) translate(-50%,-50%)', opacity: 0 }))
                        ])
                    ]),
                    trigger('contentAnim', [
                        transition('void => *', [
                            style({ opacity: '0' }),
                            animate('100ms 240ms ease-out', style({ opacity: '1' }))
                        ])
                    ])
                ],
                styles: [":host{display:block;height:100vh;width:100vw;position:absolute;--fiv-color-feature:rgba(56, 128, 255, 0.97);--fiv-color-pulse:var(--ion-color-light)}.backdrop{display:block;height:100vh;width:100vw;position:absolute}fiv-icon{--fiv-color-icon:var(--ion-color-primary)}.circle{position:absolute;border-radius:100%;background:var(--fiv-color-feature);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.feature{border-radius:100%;background:var(--fiv-color-pulse)}.content{position:absolute}.center{position:absolute;left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}"]
            }] }
];
/** @nocollapse */
FivFeatureDiscovery.ctorParameters = () => [
    { type: Renderer2 },
    { type: Platform }
];
FivFeatureDiscovery.propDecorators = {
    circle: [{ type: ViewChild, args: ['circle',] }],
    rect: [{ type: ViewChild, args: ['rect',] }],
    innerPulse: [{ type: ViewChild, args: ['pInner', { read: ElementRef },] }],
    outerPulse: [{ type: ViewChild, args: ['pOuter',] }],
    fivClick: [{ type: Output }],
    fivBackdropClick: [{ type: Output }],
    fivClose: [{ type: Output }],
    fivOpen: [{ type: Output }],
    fivAnimation: [{ type: Output }]
};
if (false) {
    /** @type {?} */
    FivFeatureDiscovery.prototype.top;
    /** @type {?} */
    FivFeatureDiscovery.prototype.left;
    /** @type {?} */
    FivFeatureDiscovery.prototype.width;
    /** @type {?} */
    FivFeatureDiscovery.prototype.height;
    /** @type {?} */
    FivFeatureDiscovery.prototype.innerDiameter;
    /** @type {?} */
    FivFeatureDiscovery.prototype.featurePadding;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentTop;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentLeft;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentWidth;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentHeight;
    /** @type {?} */
    FivFeatureDiscovery.prototype.contentOffset;
    /** @type {?} */
    FivFeatureDiscovery.prototype.bounds;
    /** @type {?} */
    FivFeatureDiscovery.prototype.icon;
    /** @type {?} */
    FivFeatureDiscovery.prototype.circle;
    /** @type {?} */
    FivFeatureDiscovery.prototype.rect;
    /** @type {?} */
    FivFeatureDiscovery.prototype.innerPulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.outerPulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.animationState;
    /** @type {?} */
    FivFeatureDiscovery.prototype.pulse;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivClick;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivBackdropClick;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivClose;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivOpen;
    /** @type {?} */
    FivFeatureDiscovery.prototype.fivAnimation;
    /**
     * @type {?}
     * @private
     */
    FivFeatureDiscovery.prototype.renderer;
    /**
     * @type {?}
     * @private
     */
    FivFeatureDiscovery.prototype.platform;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmVhdHVyZS1kaXNjb3ZlcnkuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vQGZpdmV0aHJlZS9jb3JlLyIsInNvdXJjZXMiOlsibGliL2ZlYXR1cmUtZGlzY292ZXJ5L2ZlYXR1cmUtZGlzY292ZXJ5LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFDTCxTQUFTLEVBRVQsU0FBUyxFQUVULFVBQVUsRUFDVixTQUFTLEVBQ1QsTUFBTSxFQUNOLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBRUwsT0FBTyxFQUNQLFVBQVUsRUFDVixPQUFPLEVBQ1AsS0FBSyxFQUNOLE1BQU0scUJBQXFCLENBQUM7QUFrRTdCLE1BQU0sT0FBTyxtQkFBbUI7Ozs7O0lBNEI5QixZQUFvQixRQUFtQixFQUFVLFFBQWtCO1FBQS9DLGFBQVEsR0FBUixRQUFRLENBQVc7UUFBVSxhQUFRLEdBQVIsUUFBUSxDQUFVO1FBM0JuRSxRQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ1IsU0FBSSxHQUFHLENBQUMsQ0FBQztRQUNULFVBQUssR0FBRyxHQUFHLENBQUM7UUFDWixXQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2Isa0JBQWEsR0FBRyxDQUFDLENBQUM7UUFDbEIsbUJBQWMsR0FBRyxDQUFDLENBQUM7UUFDbkIsZUFBVSxHQUFHLENBQUMsQ0FBQztRQUNmLGdCQUFXLEdBQUcsQ0FBQyxDQUFDO1FBQ2hCLGlCQUFZLEdBQUcsQ0FBQyxDQUFDO1FBQ2pCLGtCQUFhLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLGtCQUFhLEdBQUcsQ0FBQyxDQUFDO1FBUWxCLG1CQUFjLEdBQUcsUUFBUSxDQUFDO1FBQzFCLFVBQUssR0FBRyxPQUFPLENBQUM7UUFFTixhQUFRLEdBQUcsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUNuQyxxQkFBZ0IsR0FBRyxJQUFJLFlB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QUFRLEVBQUUsRUFBRSxJQUFJLEVBQUUsVUFBVSxFQUFFO3lCQUN4QyxTQUFTLFNBQUMsUUFBUTt1QkFLbEIsTUFBTTsrQkFDTixNQUFNO3VCQUNOLE1BQU07c0JBQ04sTUFBTTsyQkFDTixNQUFNOzs7O0lBekJQLGtDQUFROztJQUNSLG1DQUFTOztJQUNULG9DQUFZOztJQUNaLHFDQUFhOztJQUNiLDRDQUFrQjs7SUFDbEIsNkNBQW1COztJQUNuQix5Q0FBZTs7SUFDZiwwQ0FBZ0I7O0lBQ2hCLDJDQUFpQjs7SUFDakIsNENBQWtCOztJQUNsQiw0Q0FBa0I7O0lBQ2xCLHFDQUF3Qjs7SUFDeEIsbUNBQWE7O0lBQ2IscUNBQXdDOztJQUN4QyxtQ0FBb0M7O0lBQ3BDLHlDQUFrRTs7SUFDbEUseUNBQTRDOztJQUU1Qyw2Q0FBMEI7O0lBQzFCLG9DQUFnQjs7SUFFaEIsdUNBQTZDOztJQUM3QywrQ0FBcUQ7O0lBQ3JELHVDQUE2Qzs7SUFDN0Msc0NBQTRDOztJQUM1QywyQ0FBNEQ7Ozs7O0lBRWhELHVDQUEyQjs7Ozs7SUFBRSx1Q0FBMEIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQbGF0Zm9ybSB9IGZyb20gJ0Bpb25pYy9hbmd1bGFyJztcbmltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgT25Jbml0LFxuICBWaWV3Q2hpbGQsXG4gIEFmdGVyQ29udGVudEluaXQsXG4gIEVsZW1lbnRSZWYsXG4gIFJlbmRlcmVyMixcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXJcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICBBbmltYXRpb25FdmVudCxcbiAgdHJpZ2dlcixcbiAgdHJhbnNpdGlvbixcbiAgYW5pbWF0ZSxcbiAgc3R5bGVcbn0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5pbXBvcnQgeyBGZWF0dXJlUG9zaXRpb24gfSBmcm9tICcuLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IEZpdkljb24gfSBmcm9tICcuLi9pY29uL2ljb24uY29tcG9uZW50JztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnZml2LWZlYXR1cmUtZGlzY292ZXJ5JyxcbiAgdGVtcGxhdGVVcmw6ICcuL2ZlYXR1cmUtZGlzY292ZXJ5LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vZmVhdHVyZS1kaXNjb3ZlcnkuY29tcG9uZW50LnNjc3MnXSxcbiAgYW5pbWF0aW9uczogW1xuICAgIHRyaWdnZXIoJ3NjYWxlJywgW1xuICAgICAgdHJhbnNpdGlvbignKiA9PiB2aXNpYmxlJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDApJywgb3BhY2l0eTogJzAnIH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICcyNDBtcyBlYXNlLW91dCcsXG4gICAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxKScsIG9wYWNpdHk6ICcxJyB9KVxuICAgICAgICApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJ3Zpc2libGUgPT4gaGlkZGVuJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpJywgb3BhY2l0eTogJzEnIH0pLFxuICAgICAgICBhbmltYXRlKCcyMTVtcyBlYXNlLWluJywgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgwKScsIG9wYWNpdHk6ICcwJyB9KSlcbiAgICAgIF0pLFxuICAgICAgdHJhbnNpdGlvbigndmlzaWJsZSA9PiBleGVjdXRlJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpJywgb3BhY2l0eTogJzEnIH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICcyMTVtcyAwLjE1cyBlYXNlLWluJyxcbiAgICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEuNCknLCBvcGFjaXR5OiAnMCcgfSlcbiAgICAgICAgKVxuICAgICAgXSlcbiAgICBdKSxcbiAgICB0cmlnZ2VyKCdwdWxzZScsIFtcbiAgICAgIHRyYW5zaXRpb24oJ3NtYWxsID0+IGJpZycsIFtcbiAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKScgfSksXG4gICAgICAgIGFuaW1hdGUoXG4gICAgICAgICAgJzEwMDBtcycsXG4gICAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxLjEpIHRyYW5zbGF0ZSgtNDUlLC00NSUpJyB9KVxuICAgICAgICApXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJ2JpZyA9PiBzbWFsbCcsIFtcbiAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxLjEpIHRyYW5zbGF0ZSgtNDUlLC00NSUpJyB9KSxcbiAgICAgICAgYW5pbWF0ZSgnNDAwbXMnLCBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpJyB9KSlcbiAgICAgIF0pXG4gICAgXSksXG4gICAgdHJpZ2dlcigncHVsc2VGYWRlJywgW1xuICAgICAgdHJhbnNpdGlvbignc21hbGwgPT4gYmlnJywgW1xuICAgICAgICBzdHlsZSh7IHRyYW5zZm9ybTogJ3NjYWxlKDEpIHRyYW5zbGF0ZSgtNTAlLC01MCUpJywgb3BhY2l0eTogMC44IH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICcxMDAwbXMnLFxuICAgICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMS42KSB0cmFuc2xhdGUoLTI4JSwtMjglKScsIG9wYWNpdHk6IDAgfSlcbiAgICAgICAgKVxuICAgICAgXSksXG4gICAgICB0cmFuc2l0aW9uKCdiaWcgPT4gc21hbGwnLCBbXG4gICAgICAgIHN0eWxlKHsgdHJhbnNmb3JtOiAnc2NhbGUoMSkgdHJhbnNsYXRlKC01MCUsLTUwJSknLCBvcGFjaXR5OiAwIH0pLFxuICAgICAgICBhbmltYXRlKFxuICAgICAgICAgICc0MDBtcycsXG4gICAgICAgICAgc3R5bGUoeyB0cmFuc2Zvcm06ICdzY2FsZSgxKSB0cmFuc2xhdGUoLTUwJSwtNTAlKScsIG9wYWNpdHk6IDAgfSlcbiAgICAgICAgKVxuICAgICAgXSlcbiAgICBdKSxcbiAgICB0cmlnZ2VyKCdjb250ZW50QW5pbScsIFtcbiAgICAgIHRyYW5zaXRpb24oJ3ZvaWQgPT4gKicsIFtcbiAgICAgICAgc3R5bGUoeyBvcGFjaXR5OiAnMCcgfSksXG4gICAgICAgIGFuaW1hdGUoJzEwMG1zIDI0MG1zIGVhc2Utb3V0Jywgc3R5bGUoeyBvcGFjaXR5OiAnMScgfSkpXG4gICAgICBdKVxuICAgIF0pXG4gIF1cbn0pXG5leHBvcnQgY2xhc3MgRml2RmVhdHVyZURpc2NvdmVyeSBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJDb250ZW50SW5pdCB7XG4gIHRvcCA9IDA7XG4gIGxlZnQgPSAwO1xuICB3aWR0aCA9IDQyMDtcbiAgaGVpZ2h0ID0gNDIwO1xuICBpbm5lckRpYW1ldGVyID0gMDtcbiAgZmVhdHVyZVBhZGRpbmcgPSAwO1xuICBjb250ZW50VG9wID0gMDtcbiAgY29udGVudExlZnQgPSAwO1xuICBjb250ZW50V2lkdGggPSAwO1xuICBjb250ZW50SGVpZ2h0ID0gMDtcbiAgY29udGVudE9mZnNldCA9IDA7XG4gIGJvdW5kczogRmVhdHVyZVBvc2l0aW9uO1xuICBpY29uOiBzdHJpbmc7XG4gIEBWaWV3Q2hpbGQoJ2NpcmNsZScpIGNpcmNsZTogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgncmVjdCcpIHJlY3Q6IEVsZW1lbnRSZWY7XG4gIEBWaWV3Q2hpbGQoJ3BJbm5lcicsIHsgcmVhZDogRWxlbWVudFJlZiB9KSBpbm5lclB1bHNlOiBFbGVtZW50UmVmO1xuICBAVmlld0NoaWxkKCdwT3V0ZXInKSBvdXRlclB1bHNlOiBFbGVtZW50UmVmO1xuXG4gIGFuaW1hdGlvblN0YXRlID0gJ2hpZGRlbic7XG4gIHB1bHNlID0gJ3NtYWxsJztcblxuICBAT3V0cHV0KCkgZml2Q2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIGZpdkJhY2tkcm9wQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcbiAgQE91dHB1dCgpIGZpdkNsb3NlID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIEBPdXRwdXQoKSBmaXZPcGVuID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gIEBPdXRwdXQoKSBmaXZBbmltYXRpb24gPSBuZXcgRXZlbnRFbWl0dGVyPEFuaW1hdGlvbkV2ZW50PigpO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyMiwgcHJpdmF0ZSBwbGF0Zm9ybTogUGxhdGZvcm0pIHt9XG5cbiAgbmdPbkluaXQoKSB7fVxuXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpOiB2b2lkIHt9XG5cbiAgc2V0Qm91bmRzKGJvdW5kczogRmVhdHVyZVBvc2l0aW9uKSB7XG4gICAgdGhpcy5ib3VuZHMgPSBib3VuZHM7XG4gICAgdGhpcy5pbm5lckRpYW1ldGVyID1cbiAgICAgIGJvdW5kcy5oZWlnaHQgPiBib3VuZHMud2lkdGggPyBib3VuZHMuaGVpZ2h0IDogYm91bmRzLndpZHRoO1xuICAgIHRoaXMudG9wID0gYm91bmRzLnRvcCArIGJvdW5kcy5oZWlnaHQgLyAyIC0gdGhpcy5oZWlnaHQgLyAyO1xuICAgIHRoaXMubGVmdCA9IGJvdW5kcy5sZWZ0ICsgYm91bmRzLndpZHRoIC8gMiAtIHRoaXMud2lkdGggLyAyO1xuICAgIHRoaXMuY2FsY3VsYXRlQ29udGVudEJvdW5kcygpO1xuICAgIGlmICghdGhpcy5pY29uKSB7XG4gICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWxpbmUtbGVuZ3RoXG4gICAgICBjb25zdCBncmFkaWVudCA9IGAtd2Via2l0LXJhZGlhbC1ncmFkaWVudCh0cmFuc3BhcmVudCAke3RoaXNcbiAgICAgICAgLmlubmVyRGlhbWV0ZXIgL1xuICAgICAgICAyICtcbiAgICAgICAgNX1weCwgdmFyKC0tZml2LWNvbG9yLWZlYXR1cmUpICR7dGhpcy5pbm5lckRpYW1ldGVyIC8gMiArIDV9cHgpYDtcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtbGluZS1sZW5ndGhcbiAgICAgIGNvbnN0IHB1bHNlR3JhZGllbnQgPSBgLXdlYmtpdC1yYWRpYWwtZ3JhZGllbnQodHJhbnNwYXJlbnQgJHt0aGlzXG4gICAgICAgIC5pbm5lckRpYW1ldGVyIC9cbiAgICAgICAgMiArXG4gICAgICAgIDV9cHgsIHZhcigtLWZpdi1jb2xvci1wdWxzZSkgJHt0aGlzLmlubmVyRGlhbWV0ZXIgLyAyICsgNX1weClgO1xuICAgICAgdGhpcy5yZW5kZXJlci5zZXRTdHlsZSh0aGlzLmNpcmNsZS5uYXRpdmVFbGVtZW50LCAnYmFja2dyb3VuZCcsIGdyYWRpZW50KTtcbiAgICAgIHRoaXMucmVuZGVyZXIuc2V0U3R5bGUoXG4gICAgICAgIHRoaXMuaW5uZXJQdWxzZS5uYXRpdmVFbGVtZW50LFxuICAgICAgICAnYmFja2dyb3VuZCcsXG4gICAgICAgIHB1bHNlR3JhZGllbnRcbiAgICAgICk7XG4gICAgICB0aGlzLnJlbmRlcmVyLnNldFN0eWxlKFxuICAgICAgICB0aGlzLm91dGVyUHVsc2UubmF0aXZlRWxlbWVudCxcbiAgICAgICAgJ2JhY2tncm91bmQnLFxuICAgICAgICBwdWxzZUdyYWRpZW50XG4gICAgICApO1xuICAgIH1cbiAgfVxuICBjYWxjdWxhdGVDb250ZW50Qm91bmRzKCkge1xuICAgIGNvbnN0IGFic29sdXRlQ2VudGVyOiB7IHg6IG51bWJlcjsgeTogbnVtYmVyIH0gPSB7XG4gICAgICB4OiB0aGlzLnBsYXRmb3JtLndpZHRoKCkgLyAyLFxuICAgICAgeTogdGhpcy5wbGF0Zm9ybS5oZWlnaHQoKSAvIDJcbiAgICB9O1xuICAgIGNvbnN0IGNlbnRlcjogeyB4OiBudW1iZXI7IHk6IG51bWJlciB9ID0ge1xuICAgICAgeDogdGhpcy5sZWZ0ICsgdGhpcy53aWR0aCAvIDIsXG4gICAgICB5OiB0aGlzLnRvcCArIHRoaXMud2lkdGggLyAyXG4gICAgfTtcbiAgICBjb25zdCByZWN0V2lkdGggPSBNYXRoLnNxcnQoTWF0aC5wb3codGhpcy53aWR0aCwgMikgLyAyKTtcbiAgICBjb25zdCBpc1RvcCA9IGNlbnRlci55IDwgYWJzb2x1dGVDZW50ZXIueTtcbiAgICBjb25zdCBpc0xlZnQgPSBjZW50ZXIueCA8IGFic29sdXRlQ2VudGVyLng7XG4gICAgY29uc3QgaW5uZXJSYWRpdXMgPSB0aGlzLmlubmVyRGlhbWV0ZXIgLyAyO1xuICAgIGNvbnN0IHBhZGRpbmcgPSB0aGlzLmZlYXR1cmVQYWRkaW5nIC8gMjtcbiAgICBsZXQgY29udGVudFJpZ2h0ID0gMDtcbiAgICBsZXQgY29udGVudEJvdHRvbSA9IDA7XG4gICAgaWYgKGlzTGVmdCkge1xuICAgICAgdGhpcy5jb250ZW50TGVmdCA9IGNlbnRlci54IC0gaW5uZXJSYWRpdXM7XG4gICAgICBjb250ZW50UmlnaHQgPSBNYXRoLm1pbihcbiAgICAgICAgY2VudGVyLnggKyByZWN0V2lkdGggLyAyICsgdGhpcy5jb250ZW50T2Zmc2V0LFxuICAgICAgICB0aGlzLnBsYXRmb3JtLndpZHRoKClcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29udGVudExlZnQgPSBNYXRoLm1heChcbiAgICAgICAgY2VudGVyLnggLSByZWN0V2lkdGggLyAyIC0gdGhpcy5jb250ZW50T2Zmc2V0LFxuICAgICAgICAwXG4gICAgICApO1xuICAgICAgY29udGVudFJpZ2h0ID0gY2VudGVyLnggKyBpbm5lclJhZGl1cztcbiAgICB9XG4gICAgaWYgKGlzVG9wKSB7XG4gICAgICB0aGlzLmNvbnRlbnRUb3AgPSBjZW50ZXIueSArIGlubmVyUmFkaXVzICsgcGFkZGluZztcbiAgICAgIGNvbnRlbnRCb3R0b20gPSBjZW50ZXIueSArIHJlY3RXaWR0aCAvIDIgKyAtMSAqIHRoaXMuY29udGVudE9mZnNldDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5jb250ZW50VG9wID0gY2VudGVyLnkgLSByZWN0V2lkdGggLyAyICsgdGhpcy5jb250ZW50T2Zmc2V0O1xuICAgICAgY29udGVudEJvdHRvbSA9IGNlbnRlci55IC0gaW5uZXJSYWRpdXMgLSBwYWRkaW5nO1xuICAgIH1cblxuICAgIHRoaXMuY29udGVudFdpZHRoID0gTWF0aC5hYnModGhpcy5jb250ZW50TGVmdCAtIGNvbnRlbnRSaWdodCk7XG4gICAgdGhpcy5jb250ZW50SGVpZ2h0ID0gTWF0aC5hYnModGhpcy5jb250ZW50VG9wIC0gY29udGVudEJvdHRvbSk7XG4gIH1cbiAgaGFuZGxlQ2lyY2xlQW5pbWF0aW9uKGV2ZW50OiBBbmltYXRpb25FdmVudCkge1xuICAgIHRoaXMuZml2QW5pbWF0aW9uLmVtaXQoZXZlbnQpO1xuICAgIGlmIChldmVudC50b1N0YXRlID09PSAndmlzaWJsZScpIHtcbiAgICAgIHRoaXMuZml2T3Blbi5lbWl0KCk7XG4gICAgfVxuICAgIGlmIChldmVudC5mcm9tU3RhdGUgPT09ICd2aXNpYmxlJyAmJiBldmVudC50b1N0YXRlID09PSAnaGlkZGVuJykge1xuICAgICAgdGhpcy5maXZDbG9zZS5lbWl0KCk7XG4gICAgfVxuICAgIGlmIChldmVudC5mcm9tU3RhdGUgPT09ICd2aXNpYmxlJyAmJiBldmVudC50b1N0YXRlID09PSAnZXhlY3V0ZScpIHtcbiAgICAgIHRoaXMuZml2Q2xvc2UuZW1pdCgpO1xuICAgIH1cbiAgfVxuICBoYW5kbGVGZWF0dXJlQW5pbWF0aW9uKGV2ZW50OiBBbmltYXRpb25FdmVudCkge1xuICAgIGlmIChldmVudC50b1N0YXRlID09PSAnYmlnJykge1xuICAgICAgdGhpcy5wdWxzZSA9ICdzbWFsbCc7XG4gICAgfVxuICAgIGlmIChldmVudC50b1N0YXRlID09PSAnc21hbGwnKSB7XG4gICAgICB0aGlzLnB1bHNlID0gJ2JpZyc7XG4gICAgfVxuICB9XG5cbiAgc2hvdygpIHtcbiAgICB0aGlzLmFuaW1hdGlvblN0YXRlID0gJ3Zpc2libGUnO1xuICB9XG5cbiAgaGlkZSgpIHtcbiAgICB0aGlzLmFuaW1hdGlvblN0YXRlID0gJ2hpZGRlbic7XG4gIH1cblxuICBmZWF0dXJlQ2xpY2soKSB7XG4gICAgdGhpcy5hbmltYXRpb25TdGF0ZSA9ICdleGVjdXRlJztcbiAgfVxuXG4gIHNldEljb24oaWNvbjogRml2SWNvbikge1xuICAgIGlmIChpY29uKSB7XG4gICAgICB0aGlzLmljb24gPSBpY29uLm5hbWU7XG4gICAgfVxuICB9XG59XG4iXX0=