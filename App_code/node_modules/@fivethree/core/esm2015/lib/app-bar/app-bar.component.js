/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { FivAppBarTabContent } from './app-bar-tab-content/app-bar-tab-content.component';
import { FivFab } from './../fab/fab.component';
import { Component, Input, ViewChild, Output, EventEmitter, ContentChildren, QueryList, Host, ViewChildren } from '@angular/core';
import { FivAppBarTab } from './app-bar-tab/app-bar-tab.component';
import { Router } from '@angular/router';
import { IonTabs } from '@ionic/angular';
export class FivAppBar {
    /**
     * @param {?} router
     * @param {?} tabs
     */
    constructor(router, tabs) {
        this.router = router;
        this.tabs = tabs;
        this._fabVisible = true;
        this.cutoutVisible = true;
        this.left = false;
        this.right = false;
        this.transitioning = false;
        this.icon = 'md-add';
        this.titleLayout = 'hide';
        this.fivFabClick = new EventEmitter();
    }
    /**
     * @param {?} position
     * @return {?}
     */
    set position(position) {
        if (!position) {
            return;
        }
        if (!this.fabVisible) {
            this._position = position;
            this.setPosition();
            return;
        }
        this._fabVisible = false;
        this.transitioning = true;
        if (!this._position) {
            this._position = position;
            this.onFabHidden();
            return;
        }
        this.prepareTabs(position);
        this._position = position;
    }
    /**
     * @return {?}
     */
    get position() {
        return this._position;
    }
    /**
     * @param {?} fabVisible
     * @return {?}
     */
    set fabVisible(fabVisible) {
        if (this._fabVisible === true && fabVisible === false) {
            this._fabVisible = false;
        }
        else if (this._fabVisible === false && fabVisible === true) {
            this.cutoutVisible = true;
            setTimeout((/**
             * @return {?}
             */
            () => {
                this._fabVisible = true;
            }), 250);
        }
    }
    /**
     * @return {?}
     */
    get fabVisible() {
        return this._fabVisible;
    }
    /**
     * @return {?}
     */
    ngOnInit() { }
    /**
     * @return {?}
     */
    ngAfterViewInit() { }
    /**
     * @return {?}
     */
    ngAfterContentInit() {
        this.prepareTabs(this.position);
    }
    /**
     * @return {?}
     */
    onFabHidden() {
        if (this.transitioning) {
            this.setPosition();
            this.cutoutVisible = false;
            setTimeout((/**
             * @return {?}
             */
            () => {
                this.cutoutVisible = true;
                setTimeout((/**
                 * @return {?}
                 */
                () => {
                    this._fabVisible = true;
                    this.transitioning = false;
                }), 225);
            }), 225);
        }
        else {
            this.cutoutVisible = false;
        }
    }
    /**
     * @private
     * @param {?} position
     * @return {?}
     */
    prepareTabs(position) {
        if (position === 'center') {
            this.tabsLeft = this.tabComponents.toArray().slice(0, 2);
            this.tabsRight = this.tabComponents.toArray().slice(2, 4);
        }
        else if (position === 'right') {
            this.tabsLeft = this.tabComponents.toArray();
            this.tabsRight = [];
        }
        else if (position === 'left') {
            this.tabsLeft = [];
            this.tabsRight = this.tabComponents.toArray();
        }
    }
    /**
     * @private
     * @return {?}
     */
    setPosition() {
        if (this._position === 'right') {
            this.right = true;
            this.left = false;
        }
        else if (this._position === 'left') {
            this.right = false;
            this.left = true;
        }
        else {
            this.right = false;
            this.left = false;
        }
    }
    /**
     * @return {?}
     */
    fabClick() {
        this.fivFabClick.emit(this);
    }
    /**
     * @param {?} event
     * @return {?}
     */
    ionTabButtonClick(event) {
        this.tabs.select(event.tab);
    }
}
FivAppBar.decorators = [
    { type: Component, args: [{
                selector: 'fiv-app-bar',
                template: "<div class=\"appbar\" [ngClass]=\"{'cutout': cutoutVisible, 'left': left, 'right': right}\">\n  <div class=\"appbar-rect left\">\n    <div class=\"tabs\">\n      <fiv-app-bar-tab-content (ionTabButtonClick)=\"ionTabButtonClick($event)\" [active]=\"router.url.endsWith(tab.href)\"\n        [tab]=\"tab.tab\" [href]=\"tab.href\" [name]=\"tab.name\" [icon]=\"tab.icon\" [badge]=\"tab.badge\"\n        [titleLayout]=\"titleLayout\" *ngFor=\"let tab of tabsLeft\"></fiv-app-bar-tab-content>\n    </div>\n  </div>\n  <fiv-fab [scroll]=\"false\" (fivHidden)=\"onFabHidden()\" [visible]=\"_fabVisible\" #fab (click)=\"fabClick()\">\n    <fiv-icon [name]=\"icon\"></fiv-icon>\n  </fiv-fab>\n  <div class=\"rect\"></div>\n  <div class=\"rect-filler\"></div>\n  <div class=\"appbar-rect right\">\n    <div class=\"tabs\">\n      <fiv-app-bar-tab-content (ionTabButtonClick)=\"ionTabButtonClick($event)\" [active]=\"router.url.endsWith(tab.href)\"\n        [tab]=\"tab.tab\" [href]=\"tab.href\" [name]=\"tab.name\" [icon]=\"tab.icon\" [badge]=\"tab.badge\"\n        [titleLayout]=\"titleLayout\" *ngFor=\"let tab of tabsRight\"></fiv-app-bar-tab-content>\n    </div>\n  </div>\n</div>",
                styles: [":host{--fiv-color-appbar:var(--ion-color-light);--fiv-color-fab:var(--ion-color-primary)}.appbar{width:100%;position:fixed;bottom:0;left:0;height:calc(84px + env(safe-area-inset-bottom));background:rgba(0,0,0,0);z-index:5000}.appbar .appbar-rect{position:absolute;width:calc(50% - 34px);height:calc(56px + env(safe-area-inset-bottom));bottom:0;box-shadow:3px -4px 5px 0 rgba(0,0,0,.1);transition:350ms}.appbar .appbar-rect.left{left:0;background:var(--fiv-color-appbar);border-top-right-radius:12px}.appbar .appbar-rect.right{right:0;background:var(--fiv-color-appbar);border-top-left-radius:12px}.appbar fiv-fab{display:block;width:56px;height:56px;-webkit-transform:translateX(-50%);transform:translateX(-50%);left:50%;position:absolute;z-index:14}.appbar fiv-fab fiv-icon{--fiv-color-icon:var(--fiv-color-fab-icon)}.appbar .rect{display:inline-block;width:68px;height:48px;position:absolute;overflow:hidden;bottom:env(safe-area-inset-bottom);left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);transition:350ms}.appbar .rect-filler{display:inline-block;width:72px;height:env(safe-area-inset-bottom);position:absolute;overflow:hidden;bottom:0;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);transition:350ms;background:var(--fiv-color-appbar)}.appbar .rect:before{content:'';position:absolute;bottom:50%;width:100%;height:100%;border-radius:100%;box-shadow:0 300px 0 300px var(--fiv-color-appbar);transition:350ms}.appbar:not(.cutout) .appbar-rect.left{border-top-right-radius:0}.appbar:not(.cutout) .appbar-rect.right{border-top-left-radius:0}.appbar:not(.cutout) .rect{height:56px;box-shadow:3px -4px 5px 0 rgba(0,0,0,.1);background:var(--fiv-color-appbar)}.appbar:not(.cutout) .rect:before{border-radius:0;bottom:100%}.appbar.left .appbar-rect.left{width:4px}.appbar.left .appbar-rect.right{width:calc(100% - 70px)}.appbar.left .rect{left:4px;-webkit-transform:translateX(0);transform:translateX(0);width:66px}.appbar.left fiv-fab{width:56px;height:56px;-webkit-transform:translateX(0);transform:translateX(0);left:10px;position:absolute}.appbar.right .appbar-rect.left{width:calc(100% - 70px)}.appbar.right .appbar-rect.right{width:4px}.appbar.right .rect{left:calc(100% - 37px);width:67px}.appbar.right fiv-fab{width:56px;height:56px;-webkit-transform:translateX(0);transform:translateX(0);left:calc(100% - 64px);position:absolute;--fiv-spinner-size:68px}.tabs{display:flex;width:100%;height:100%;position:relative}"]
            }] }
];
/** @nocollapse */
FivAppBar.ctorParameters = () => [
    { type: Router },
    { type: IonTabs, decorators: [{ type: Host }] }
];
FivAppBar.propDecorators = {
    fab: [{ type: ViewChild, args: ['fab',] }],
    icon: [{ type: Input }],
    titleLayout: [{ type: Input }],
    fivFabClick: [{ type: Output }],
    _tabs: [{ type: ViewChildren, args: [FivAppBarTabContent,] }],
    tabComponents: [{ type: ContentChildren, args: [FivAppBarTab,] }],
    position: [{ type: Input }],
    fabVisible: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    FivAppBar.prototype._fabVisible;
    /** @type {?} */
    FivAppBar.prototype.cutoutVisible;
    /** @type {?} */
    FivAppBar.prototype._position;
    /** @type {?} */
    FivAppBar.prototype.left;
    /** @type {?} */
    FivAppBar.prototype.right;
    /** @type {?} */
    FivAppBar.prototype.transitioning;
    /** @type {?} */
    FivAppBar.prototype.tabsRight;
    /** @type {?} */
    FivAppBar.prototype.tabsLeft;
    /** @type {?} */
    FivAppBar.prototype.fab;
    /** @type {?} */
    FivAppBar.prototype.icon;
    /** @type {?} */
    FivAppBar.prototype.titleLayout;
    /** @type {?} */
    FivAppBar.prototype.fivFabClick;
    /** @type {?} */
    FivAppBar.prototype._tabs;
    /** @type {?} */
    FivAppBar.prototype.tabComponents;
    /** @type {?} */
    FivAppBar.prototype.router;
    /** @type {?} */
    FivAppBar.prototype.tabs;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXBwLWJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AZml2ZXRocmVlL2NvcmUvIiwic291cmNlcyI6WyJsaWIvYXBwLWJhci9hcHAtYmFyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLG1CQUFtQixFQUFFLE1BQU0scURBQXFELENBQUM7QUFDMUYsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ2hELE9BQU8sRUFDTCxTQUFTLEVBRVQsS0FBSyxFQUNMLFNBQVMsRUFDVCxNQUFNLEVBQ04sWUFBWSxFQUNaLGVBQWUsRUFDZixTQUFTLEVBR1QsSUFBSSxFQUNKLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0scUNBQXFDLENBQUM7QUFDbkUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBRXpDLE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQVF6QyxNQUFNLE9BQU8sU0FBUzs7Ozs7SUEyRHBCLFlBQW1CLE1BQWMsRUFBaUIsSUFBYTtRQUE1QyxXQUFNLEdBQU4sTUFBTSxDQUFRO1FBQWlCLFNBQUksR0FBSixJQUFJLENBQVM7UUExRC9ELGdCQUFXLEdBQUcsSUFBSSxDQUFDO1FBQ25CLGtCQUFhLEdBQUcsSUFBSSxDQUFDO1FBRXJCLFNBQUksR0FBRyxLQUFLLENBQUM7UUFDYixVQUFLLEdBQUcsS0FBSyxDQUFDO1FBQ2Qsa0JBQWEsR0FBRyxLQUFLLENBQUM7UUFLYixTQUFJLEdBQUcsUUFBUSxDQUFDO1FBQ2hCLGdCQUFXLEdBQXNCLE1BQU0sQ0FBQztRQUN2QyxnQkFBVyxHQUFHLElBQUksWUFBWSxFQUFhLENBQUM7SUE4Q1ksQ0FBQzs7Ozs7SUF6Q25FLElBQ0ksUUFBUSxDQUFDLFFBQTJCO1FBQ3RDLElBQUksQ0FBQyxRQUFRLEVBQUU7WUFDYixPQUFPO1NB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LHlCQUFhOztJQUNiLDBCQUFjOztJQUNkLGtDQUFzQjs7SUFDdEIsOEJBQTBCOztJQUMxQiw2QkFBeUI7O0lBRXpCLHdCQUE4Qjs7SUFDOUIseUJBQXlCOztJQUN6QixnQ0FBaUQ7O0lBQ2pELGdDQUFzRDs7SUFDdEQsMEJBQXlFOztJQUV6RSxrQ0FBc0U7O0lBMkMxRCwyQkFBcUI7O0lBQUUseUJBQTRCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRml2QXBwQmFyVGFiQ29udGVudCB9IGZyb20gJy4vYXBwLWJhci10YWItY29udGVudC9hcHAtYmFyLXRhYi1jb250ZW50LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBGaXZGYWIgfSBmcm9tICcuLy4uL2ZhYi9mYWIuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIENvbXBvbmVudCxcbiAgT25Jbml0LFxuICBJbnB1dCxcbiAgVmlld0NoaWxkLFxuICBPdXRwdXQsXG4gIEV2ZW50RW1pdHRlcixcbiAgQ29udGVudENoaWxkcmVuLFxuICBRdWVyeUxpc3QsXG4gIEFmdGVyVmlld0luaXQsXG4gIEFmdGVyQ29udGVudEluaXQsXG4gIEhvc3QsXG4gIFZpZXdDaGlsZHJlblxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEZpdkFwcEJhclRhYiB9IGZyb20gJy4vYXBwLWJhci10YWIvYXBwLWJhci10YWIuY29tcG9uZW50JztcbmltcG9ydCB7IFJvdXRlciB9IGZyb20gJ0Bhbmd1bGFyL3JvdXRlcic7XG5pbXBvcnQgeyBBcHBCYXJUaXRsZUxheW91dCwgQXBwQmFyRmFiUG9zaXRpb24gfSBmcm9tICcuLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IElvblRhYnMgfSBmcm9tICdAaW9uaWMvYW5ndWxhcic7XG5pbXBvcnQgeyBUYWJCdXR0b25DbGlja0V2ZW50RGV0YWlsIH0gZnJvbSAnQGlvbmljL2NvcmUnO1xuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICdmaXYtYXBwLWJhcicsXG4gIHRlbXBsYXRlVXJsOiAnLi9hcHAtYmFyLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vYXBwLWJhci5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIEZpdkFwcEJhciBpbXBsZW1lbnRzIE9uSW5pdCwgQWZ0ZXJWaWV3SW5pdCwgQWZ0ZXJDb250ZW50SW5pdCB7XG4gIF9mYWJWaXNpYmxlID0gdHJ1ZTtcbiAgY3V0b3V0VmlzaWJsZSA9IHRydWU7XG4gIF9wb3NpdGlvbjogQXBwQmFyRmFiUG9zaXRpb247XG4gIGxlZnQgPSBmYWxzZTtcbiAgcmlnaHQgPSBmYWxzZTtcbiAgdHJhbnNpdGlvbmluZyA9IGZhbHNlO1xuICB0YWJzUmlnaHQ6IEZpdkFwcEJhclRhYltdO1xuICB0YWJzTGVmdDogRml2QXBwQmFyVGFiW107XG5cbiAgQFZpZXdDaGlsZCgnZmFiJykgZmFiOiBGaXZGYWI7XG4gIEBJbnB1dCgpIGljb24gPSAnbWQtYWRkJztcbiAgQElucHV0KCkgdGl0bGVMYXlvdXQ6IEFwcEJhclRpdGxlTGF5b3V0ID0gJ2hpZGUnO1xuICBAT3V0cHV0KCkgZml2RmFiQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPEZpdkFwcEJhcj4oKTtcbiAgQFZpZXdDaGlsZHJlbihGaXZBcHBCYXJUYWJDb250ZW50KSBfdGFiczogUXVlcnlMaXN0PEZpdkFwcEJhclRhYkNvbnRlbnQ+O1xuXG4gIEBDb250ZW50Q2hpbGRyZW4oRml2QXBwQmFyVGFiKSB0YWJDb21wb25lbnRzOiBRdWVyeUxpc3Q8Rml2QXBwQmFyVGFiPjtcblxuICBASW5wdXQoKVxuICBzZXQgcG9zaXRpb24ocG9zaXRpb246IEFwcEJhckZhYlBvc2l0aW9uKSB7XG4gICAgaWYgKCFwb3NpdGlvbikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5mYWJWaXNpYmxlKSB7XG4gICAgICB0aGlzLl9wb3NpdGlvbiA9IHBvc2l0aW9uO1xuICAgICAgdGhpcy5zZXRQb3NpdGlvbigpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2ZhYlZpc2libGUgPSBmYWxzZTtcbiAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSB0cnVlO1xuICAgIGlmICghdGhpcy5fcG9zaXRpb24pIHtcbiAgICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gICAgICB0aGlzLm9uRmFiSGlkZGVuKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMucHJlcGFyZVRhYnMocG9zaXRpb24pO1xuICAgIHRoaXMuX3Bvc2l0aW9uID0gcG9zaXRpb247XG4gIH1cbiAgZ2V0IHBvc2l0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLl9wb3NpdGlvbjtcbiAgfVxuXG4gIEBJbnB1dCgpXG4gIHNldCBmYWJWaXNpYmxlKGZhYlZpc2libGU6IGJvb2xlYW4pIHtcbiAgICBpZiAodGhpcy5fZmFiVmlzaWJsZSA9PT0gdHJ1ZSAmJiBmYWJWaXNpYmxlID09PSBmYWxzZSkge1xuICAgICAgdGhpcy5fZmFiVmlzaWJsZSA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAodGhpcy5fZmFiVmlzaWJsZSA9PT0gZmFsc2UgJiYgZmFiVmlzaWJsZSA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5jdXRvdXRWaXNpYmxlID0gdHJ1ZTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLl9mYWJWaXNpYmxlID0gdHJ1ZTtcbiAgICAgIH0sIDI1MCk7XG4gICAgfVxuICB9XG4gIGdldCBmYWJWaXNpYmxlKCkge1xuICAgIHJldHVybiB0aGlzLl9mYWJWaXNpYmxlO1xuICB9XG5cbiAgY29uc3RydWN0b3IocHVibGljIHJvdXRlcjogUm91dGVyLCBASG9zdCgpIHB1YmxpYyB0YWJzOiBJb25UYWJzKSB7fVxuXG4gIG5nT25Jbml0KCkge31cblxuICBuZ0FmdGVyVmlld0luaXQoKTogdm9pZCB7fVxuXG4gIG5nQWZ0ZXJDb250ZW50SW5pdCgpIHtcbiAgICB0aGlzLnByZXBhcmVUYWJzKHRoaXMucG9zaXRpb24pO1xuICB9XG5cbiAgb25GYWJIaWRkZW4oKSB7XG4gICAgaWYgKHRoaXMudHJhbnNpdGlvbmluZykge1xuICAgICAgdGhpcy5zZXRQb3NpdGlvbigpO1xuXG4gICAgICB0aGlzLmN1dG91dFZpc2libGUgPSBmYWxzZTtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB0aGlzLmN1dG91dFZpc2libGUgPSB0cnVlO1xuICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9mYWJWaXNpYmxlID0gdHJ1ZTtcbiAgICAgICAgICB0aGlzLnRyYW5zaXRpb25pbmcgPSBmYWxzZTtcbiAgICAgICAgfSwgMjI1KTtcbiAgICAgIH0sIDIyNSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY3V0b3V0VmlzaWJsZSA9IGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgcHJlcGFyZVRhYnMocG9zaXRpb246IEFwcEJhckZhYlBvc2l0aW9uKSB7XG4gICAgaWYgKHBvc2l0aW9uID09PSAnY2VudGVyJykge1xuICAgICAgdGhpcy50YWJzTGVmdCA9IHRoaXMudGFiQ29tcG9uZW50cy50b0FycmF5KCkuc2xpY2UoMCwgMik7XG4gICAgICB0aGlzLnRhYnNSaWdodCA9IHRoaXMudGFiQ29tcG9uZW50cy50b0FycmF5KCkuc2xpY2UoMiwgNCk7XG4gICAgfSBlbHNlIGlmIChwb3NpdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgdGhpcy50YWJzTGVmdCA9IHRoaXMudGFiQ29tcG9uZW50cy50b0FycmF5KCk7XG4gICAgICB0aGlzLnRhYnNSaWdodCA9IFtdO1xuICAgIH0gZWxzZSBpZiAocG9zaXRpb24gPT09ICdsZWZ0Jykge1xuICAgICAgdGhpcy50YWJzTGVmdCA9IFtdO1xuICAgICAgdGhpcy50YWJzUmlnaHQgPSB0aGlzLnRhYkNvbXBvbmVudHMudG9BcnJheSgpO1xuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgc2V0UG9zaXRpb24oKSB7XG4gICAgaWYgKHRoaXMuX3Bvc2l0aW9uID09PSAncmlnaHQnKSB7XG4gICAgICB0aGlzLnJpZ2h0ID0gdHJ1ZTtcbiAgICAgIHRoaXMubGVmdCA9IGZhbHNlO1xuICAgIH0gZWxzZSBpZiAodGhpcy5fcG9zaXRpb24gPT09ICdsZWZ0Jykge1xuICAgICAgdGhpcy5yaWdodCA9IGZhbHNlO1xuICAgICAgdGhpcy5sZWZ0ID0gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yaWdodCA9IGZhbHNlO1xuICAgICAgdGhpcy5sZWZ0ID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgZmFiQ2xpY2soKSB7XG4gICAgdGhpcy5maXZGYWJDbGljay5lbWl0KHRoaXMpO1xuICB9XG5cbiAgaW9uVGFiQnV0dG9uQ2xpY2soZXZlbnQ6IFRhYkJ1dHRvbkNsaWNrRXZlbnREZXRhaWwpIHtcbiAgICB0aGlzLnRhYnMuc2VsZWN0KGV2ZW50LnRhYik7XG4gIH1cbn1cbiJdfQ==